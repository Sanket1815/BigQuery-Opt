<html lang="en" data-rh="lang"><head><meta http-equiv="origin-trial" content="A7vZI3v+Gz7JfuRolKNM4Aff6zaGuT7X0mf3wtoZTnKv6497cVMnhy03KDqX7kBz/q/iidW7srW31oQbBt4VhgoAAACUeyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGUuY29tOjQ0MyIsImZlYXR1cmUiOiJEaXNhYmxlVGhpcmRQYXJ0eVN0b3JhZ2VQYXJ0aXRpb25pbmczIiwiZXhwaXJ5IjoxNzU3OTgwODAwLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><title>BigQuery WINDOW Functions | Advanced Techniques for Data Professionals | Google Cloud - Community</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236, app-argument=/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502, affiliate-data=pt=698524&amp;ct=smart_app_banner&amp;mt=8"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-06-25T20:34:38.652Z"><meta data-rh="true" name="title" content="BigQuery WINDOW Functions | Advanced Techniques for Data Professionals | Google Cloud - Community"><meta data-rh="true" property="og:title" content="BigQuery WINDOW Functions | Advanced Techniques for Data Professionals"><meta data-rh="true" property="al:android:url" content="medium://p/e0a6ca3f9502"><meta data-rh="true" property="al:ios:url" content="medium://p/e0a6ca3f9502"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="This article simplifies the concept of BigQuery's windows functions to enhance your data analysis skills and improve your understanding of BigQuery."><meta data-rh="true" property="og:description" content="A complete guide for maximizing the potential of BigQuery WINDOW functions to manipulate and transform data."><meta data-rh="true" property="og:url" content="https://medium.com/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502"><meta data-rh="true" property="al:web:url" content="https://medium.com/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:956/1*YFnqJT_pzovNPxnBtLuEQg.png"><meta data-rh="true" property="article:author" content="https://axel-thevenot.medium.com"><meta data-rh="true" name="author" content="Axel Thevenot üê£"><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="BigQuery WINDOW Functions | Advanced Techniques for Data Professionals"><meta data-rh="true" name="twitter:site" content="@googlecloudtech"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/e0a6ca3f9502"><meta data-rh="true" property="twitter:description" content="A complete guide for maximizing the potential of BigQuery WINDOW functions to manipulate and transform data."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:956/1*YFnqJT_pzovNPxnBtLuEQg.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="13 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" rel="manifest" href="/manifest.json"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://axel-thevenot.medium.com"><link data-rh="true" rel="canonical" href="https://medium.com/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e0a6ca3f9502"><script type="text/javascript" async="" charset="utf-8" src="https://www.gstatic.com/recaptcha/releases/07cvpCr3Xe3g2ttJNUkC6W0J/recaptcha__en_gb.js" crossorigin="anonymous" integrity="sha384-HyGZePWYiBoxOI8rEIIvh7dYm8XXVDx0IRdD421yDk3fSsOiQgyN0vbYAuZaZZTP"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"SocialMediaPosting","image":["https://miro.medium.com/1*YFnqJT_pzovNPxnBtLuEQg.png"],"url":"https://medium.com/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","dateCreated":"2023-01-09T15:20:05Z","datePublished":"2023-01-09T15:20:05Z","dateModified":"2023-06-25T20:34:38Z","headline":"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals","name":"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals","description":"This article simplifies the concept of BigQuery's windows functions to enhance your data analysis skills and improve your understanding of BigQuery.","identifier":"e0a6ca3f9502","author":{"@type":"Person","name":"Axel Thevenot üê£","url":"https://medium.com/@axel-thevenot"},"creator":["Axel Thevenot üê£"],"publisher":{"@type":"Organization","name":"Google Cloud - Community","url":"https://medium.com/google-cloud","logo":{"@type":"ImageObject","width":192,"height":192,"url":"https://miro.medium.com/v2/resize:fit:192/1*FUjLiCANvATKeaJEeg20Rw.png"}},"mainEntityOfPage":"https://medium.com/google-cloud/bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","isAccessibleForFree":true}</script><style type="text/css" data-fela-rehydration="630" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="630" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.d{display:none}.m{display:block}.n{position:sticky}.o{top:0}.p{z-index:500}.q{padding:0 24px}.r{align-items:center}.s{border-bottom:solid 1px #F2F2F2}.z{height:41px}.ab{line-height:20px}.ac{display:flex}.ae{height:57px}.af{flex:1 0 auto}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:none}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{margin-left:24px}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{flex:1 1 auto}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fg{margin-left:16px}.fh{border:inherit}.fk{margin-right:32px}.fl{position:relative}.fm{fill:#6B6B6B}.fp{background:transparent}.fq svg{margin-left:4px}.fr svg{fill:#6B6B6B}.ft{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fu{position:absolute}.fw{max-width:100%}.fx{overflow:hidden}.fy{text-overflow:ellipsis}.fz{white-space:nowrap}.ga{border-bottom:1px solid #F2F2F2}.gb{height:3px}.gc{max-width:1192px}.gi{font-weight:500}.gw{margin:0 8px}.gx{display:inline}.gy{font-size:16px}.gz{line-height:24px}.ha{pointer-events:none}.hb{will-change:opacity, transform}.hc{width:calc(100% - 0px)}.hf{opacity:0}.hg{transform:translateY(89px)}.hh{width:148px}.hi{border-radius:2px}.hj{height:38px}.hk{width:38px}.hm{margin-top:16px}.hn{word-break:break-word}.ht{margin:0 24px}.hx{background:rgba(255, 255, 255, 1)}.hy{border:1px solid #F2F2F2}.hz{box-shadow:0 1px 4px #F2F2F2}.ia{max-height:100vh}.ib{overflow-y:auto}.ic{left:0}.id{top:calc(100vh + 100px)}.ie{bottom:calc(100vh + 100px)}.if{width:10px}.ig{word-wrap:break-word}.ih:after{display:block}.ii:after{content:""}.ij:after{clear:both}.ik{line-height:1.23}.il{letter-spacing:0}.im{font-style:normal}.in{font-weight:700}.ji{margin-bottom:-0.27em}.jj{line-height:1.394}.kj{gap:12px}.kk{align-items:baseline}.kl{width:36px}.km{height:36px}.kn{border:2px solid rgba(255, 255, 255, 1)}.ko{z-index:0}.kp{box-shadow:none}.kq{border:1px solid rgba(0, 0, 0, 0.05)}.kr{margin-bottom:2px}.ks{flex-wrap:nowrap}.ku{width:12px}.kv{flex-wrap:wrap}.kw{padding-left:8px}.kx{padding-right:8px}.ly> *{flex-shrink:0}.lz{overflow-x:scroll}.ma::-webkit-scrollbar{display:none}.mb{scrollbar-width:none}.mc{-ms-overflow-style:none}.md{width:74px}.me{flex-direction:row}.mf{z-index:2}.mg{margin-right:4px}.mj{-webkit-user-select:none}.mk{border:0}.ml{fill:rgba(117, 117, 117, 1)}.mo{outline:0}.mp{user-select:none}.mq> svg{pointer-events:none}.mz{cursor:progress}.na{margin-left:4px}.nb{margin-top:0px}.nc{opacity:1}.nd{padding:4px 0}.ng{width:16px}.ni{display:inline-flex}.no{padding:8px 2px}.np svg{color:#6B6B6B}.og{margin-left:auto}.oh{margin-right:auto}.oi{max-width:956px}.oo{clear:both}.oq{cursor:zoom-in}.or{z-index:auto}.ot{width:1px}.ou{height:1px}.ov{margin:-1px}.ow{clip:rect(0, 0, 0, 0)}.ox{border-width:0}.oy{height:auto}.oz{line-height:1.58}.pa{letter-spacing:-0.004em}.pb{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.pr{margin-bottom:-0.46em}.ps{text-decoration:underline}.pt{box-shadow:inset 3px 0 0 0 #242424}.pu{padding-left:23px}.pv{margin-left:-20px}.pw{font-style:italic}.px{margin-top:32px}.py{margin-bottom:14px}.pz{padding-top:24px}.qa{padding-bottom:10px}.qb{background-color:#000000}.qc{width:3px}.qd{margin-right:20px}.qe{line-height:1.12}.qf{letter-spacing:-0.022em}.qg{font-weight:600}.qx{margin-bottom:-0.28em}.rd{padding-left:30px}.re{line-height:40px}.rf{letter-spacing:-0.009em}.rg{font-weight:300}.rh{font-size:28px}.rs{padding:2px 4px}.rt{font-size:75%}.ru> strong{font-family:inherit}.rv{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rw{overflow-x:auto}.rx{padding:32px}.ry{border:1px solid #E5E5E5}.rz{line-height:1.4}.sa{margin-top:-0.2em}.sb{margin-bottom:-0.2em}.sc{white-space:pre}.sd{min-width:fit-content}.se{margin-top:10px}.sf{max-width:728px}.si{line-height:1.18}.so{margin-bottom:-0.31em}.sp{list-style-type:disc}.sq{margin-left:30px}.sr{padding-left:0px}.tc{box-shadow:inset 0 0 0 1px #F2F2F2}.td{padding:0px}.te{flex:0 0 auto}.tf{padding:16px 20px}.th{max-height:40px}.ti{display:-webkit-box}.tj{-webkit-line-clamp:2}.tk{-webkit-box-orient:vertical}.tm{margin-top:8px}.tn{margin-top:12px}.to{width:160px}.tp{background-image:url(https://miro.medium.com/v2/resize:fit:320/1*08kcvkA64iddoMtjoErr8Q.png)}.tq{background-origin:border-box}.tr{background-size:cover}.ts{height:167px}.tt{background-position:50% 50%}.tu{margin-bottom:40px}.tv{margin-top:6px}.tw{margin-right:8px}.tx{padding:8px 16px}.ty{border-radius:100px}.tz{transition:background 300ms ease}.ub{margin-bottom:26px}.uc{border-top:none}.ud{margin-bottom:50px}.ue{height:52px}.uf{max-height:52px}.ug{box-sizing:content-box}.uh{position:static}.ui{z-index:1}.uk{max-width:155px}.uq{margin-bottom:64px}.ur{margin-bottom:48px}.ve{height:48px}.vf{width:48px}.vg{height:64px}.vh{width:64px}.vi{align-self:flex-end}.vo{padding-right:4px}.vv{white-space:pre-wrap}.wb{height:0px}.wc{gap:18px}.wd{fill:rgba(61, 61, 61, 1)}.wf{padding-bottom:20px}.wl{fill:#242424}.wm{background:0}.wn{border-color:#242424}.wp:disabled:hover{color:#242424}.wq:disabled:hover{fill:#242424}.wr:disabled:hover{border-color:#242424}.xc{border-bottom:solid 1px #E5E5E5}.xd{margin-top:72px}.xe{padding:24px 0}.xf{margin-bottom:0px}.xg{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fn:hover{color:#242424}.fo:hover{fill:#242424}.fs:hover svg{fill:#242424}.fv:hover{background-color:rgba(0, 0, 0, 0.1)}.hl:hover{background-color:none}.kt:hover{text-decoration:underline}.mn:hover{fill:rgba(8, 8, 8, 1)}.ne:hover{fill:#000000}.nf:hover p{color:#000000}.nh:hover{color:#000000}.nq:hover svg{color:#000000}.ua:hover{background-color:#F2F2F2}.we:hover{fill:rgba(25, 25, 25, 1)}.wo:hover{border-color:#242424}.bd:focus-within path{fill:#242424}.mm:focus{fill:rgba(8, 8, 8, 1)}.nr:focus svg{color:#000000}.os:focus{transform:scale(1.01)}.mr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (min-width: 1080px)">.e{display:none}.bv{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fj{display:flex}.gh{max-width:250px}.gt{font-size:20px}.gu{line-height:24px}.gv{letter-spacing:0}.hs{margin-bottom:50px}.hw{max-width:680px}.je{font-size:42px}.jf{margin-top:1.19em}.jg{line-height:52px}.jh{letter-spacing:-0.011em}.jw{font-size:22px}.jx{margin-top:0.92em}.jy{line-height:28px}.kh{align-items:center}.ki{flex-direction:row}.lk{border-top:solid 1px #F2F2F2}.ll{border-bottom:solid 1px #F2F2F2}.lm{margin:32px 0 0}.ln{padding:3px 8px}.lw> *{margin-right:24px}.lx> :last-child{margin-right:0}.my{margin-top:0px}.nn{margin:0}.on{margin-top:56px}.po{margin-top:2.14em}.pp{line-height:32px}.pq{letter-spacing:-0.003em}.qt{font-size:24px}.qu{margin-top:1.25em}.qv{line-height:30px}.qw{letter-spacing:-0.016em}.rc{margin-top:0.94em}.rm{margin-top:1.75em}.rr{margin-top:2.64em}.sn{margin-top:1.72em}.sw{margin-top:1.14em}.tb{margin-top:32px}.up{display:inline-block}.uu{margin-bottom:0}.uv{margin-right:20px}.vj{max-width:500px}.wa{margin-bottom:88px}.wk{margin:40px 0 16px}.ww{width:min-width}.xb{padding-top:72px}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.f{display:none}.mx{margin-top:0px}.sg{margin-left:auto}.sh{text-align:center}.uo{display:inline-block}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (max-width: 903.98px)">.g{display:none}.mw{margin-top:0px}.un{display:inline-block}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (max-width: 727.98px)">.h{display:none}.mu{margin-top:0px}.mv{margin-right:0px}.tg{padding:10px 12px 10px}.um{display:inline-block}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (max-width: 551.98px)">.i{display:none}.t{display:flex}.u{justify-content:space-between}.br{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.gd{max-width:150px}.gj{font-size:16px}.gk{letter-spacing:0}.ho{margin-bottom:2px}.io{font-size:32px}.ip{margin-top:1.01em}.iq{line-height:38px}.ir{letter-spacing:-0.014em}.jk{font-size:18px}.jl{margin-top:0.79em}.jm{line-height:24px}.jz{align-items:flex-start}.ka{flex-direction:column-reverse}.ky{margin:24px -24px 0}.kz{padding:0}.lo> *{margin-right:8px}.lp> :last-child{margin-right:24px}.mh{margin-left:0px}.ms{margin-top:0px}.mt{margin-right:0px}.nj{margin:0}.ns{border:1px solid #F2F2F2}.nt{border-radius:99em}.nu{padding:0px 16px 0px 12px}.nv{height:38px}.nw{align-items:center}.ny svg{margin-right:8px}.oj{margin-top:40px}.pc{margin-top:1.56em}.pd{line-height:28px}.pe{letter-spacing:-0.003em}.qh{font-size:20px}.qi{margin-top:0.93em}.qy{margin-top:0.67em}.ri{margin-top:1.08em}.rn{margin-top:2em}.sj{margin-top:1.23em}.ss{margin-top:1.34em}.sx{margin-top:24px}.ul{display:inline-block}.ut{flex-direction:column}.vc{margin-bottom:20px}.vd{margin-right:0}.vn{max-width:100%}.vp{font-size:24px}.vq{line-height:30px}.vr{letter-spacing:-0.016em}.vw{margin-bottom:64px}.wg{margin:32px 0 16px}.ws{width:100%}.wx{padding-top:48px}.nx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.bu{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fi{display:flex}.gg{max-width:250px}.gq{font-size:20px}.gr{line-height:24px}.gs{letter-spacing:0}.hr{margin-bottom:50px}.hv{max-width:680px}.ja{font-size:42px}.jb{margin-top:1.19em}.jc{line-height:52px}.jd{letter-spacing:-0.011em}.jt{font-size:22px}.ju{margin-top:0.92em}.jv{line-height:28px}.kf{align-items:center}.kg{flex-direction:row}.lg{border-top:solid 1px #F2F2F2}.lh{border-bottom:solid 1px #F2F2F2}.li{margin:32px 0 0}.lj{padding:3px 8px}.lu> *{margin-right:24px}.lv> :last-child{margin-right:0}.nm{margin:0}.om{margin-top:56px}.pl{margin-top:2.14em}.pm{line-height:32px}.pn{letter-spacing:-0.003em}.qp{font-size:24px}.qq{margin-top:1.25em}.qr{line-height:30px}.qs{letter-spacing:-0.016em}.rb{margin-top:0.94em}.rl{margin-top:1.75em}.rq{margin-top:2.64em}.sm{margin-top:1.72em}.sv{margin-top:1.14em}.ta{margin-top:32px}.uw{margin-bottom:0}.ux{margin-right:20px}.vk{max-width:500px}.vz{margin-bottom:88px}.wj{margin:40px 0 16px}.wv{width:min-width}.xa{padding-top:72px}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.x{display:flex}.y{justify-content:space-between}.bt{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.gf{max-width:250px}.gn{font-size:20px}.go{line-height:24px}.gp{letter-spacing:0}.hq{margin-bottom:50px}.hu{max-width:680px}.iw{font-size:42px}.ix{margin-top:1.19em}.iy{line-height:52px}.iz{letter-spacing:-0.011em}.jq{font-size:22px}.jr{margin-top:0.92em}.js{line-height:28px}.kd{align-items:center}.ke{flex-direction:row}.lc{border-top:solid 1px #F2F2F2}.ld{border-bottom:solid 1px #F2F2F2}.le{margin:32px 0 0}.lf{padding:3px 8px}.ls> *{margin-right:24px}.lt> :last-child{margin-right:0}.nl{margin:0}.ol{margin-top:56px}.pi{margin-top:2.14em}.pj{line-height:32px}.pk{letter-spacing:-0.003em}.ql{font-size:24px}.qm{margin-top:1.25em}.qn{line-height:30px}.qo{letter-spacing:-0.016em}.ra{margin-top:0.94em}.rk{margin-top:1.75em}.rp{margin-top:2.64em}.sl{margin-top:1.72em}.su{margin-top:1.14em}.sz{margin-top:32px}.uy{margin-bottom:0}.uz{margin-right:20px}.vl{max-width:500px}.vy{margin-bottom:88px}.wi{margin:40px 0 16px}.wu{width:min-width}.wz{padding-top:72px}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.v{display:flex}.w{justify-content:space-between}.bs{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.ge{max-width:150px}.gl{font-size:16px}.gm{letter-spacing:0}.hp{margin-bottom:2px}.is{font-size:32px}.it{margin-top:1.01em}.iu{line-height:38px}.iv{letter-spacing:-0.014em}.jn{font-size:18px}.jo{margin-top:0.79em}.jp{line-height:24px}.kb{align-items:flex-start}.kc{flex-direction:column-reverse}.la{margin:24px 0 0}.lb{padding:0}.lq> *{margin-right:8px}.lr> :last-child{margin-right:8px}.mi{margin-left:0px}.nk{margin:0}.nz{border:1px solid #F2F2F2}.oa{border-radius:99em}.ob{padding:0px 16px 0px 12px}.oc{height:38px}.od{align-items:center}.of svg{margin-right:8px}.ok{margin-top:40px}.pf{margin-top:1.56em}.pg{line-height:28px}.ph{letter-spacing:-0.003em}.qj{font-size:20px}.qk{margin-top:0.93em}.qz{margin-top:0.67em}.rj{margin-top:1.08em}.ro{margin-top:2em}.sk{margin-top:1.23em}.st{margin-top:1.34em}.sy{margin-top:24px}.us{flex-direction:column}.va{margin-bottom:20px}.vb{margin-right:0}.vm{max-width:100%}.vs{font-size:24px}.vt{line-height:30px}.vu{letter-spacing:-0.016em}.vx{margin-bottom:64px}.wh{margin:32px 0 16px}.wt{width:100%}.wy{padding-top:48px}.oe:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="print">.uj{display:none}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.hd{transition:opacity 200ms}.op{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="all and (max-width: 1232px)">.he{display:none}</style><style type="text/css" data-fela-rehydration="630" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.tl{max-height:none}</style><link rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:190:190/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:150:150/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:95:95/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:75:75/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:625:625/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717" data-rh="true"><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener banner closeBanner closeJourney data deepview deepviewCta first init link logout removeListener setBranchViewData setIdentity track trackCommerceEvent logEvent disableTracking getBrowserFingerprintId crossPlatformIds lastAttributedTouchData setAPIResponseCallback qrCode setRequestMetaData setAPIUrl getAPIUrl setDMAParamsForEEA".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><style id="googleidentityservice_button_styles">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-u2z5K{height:36px;width:36px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;-webkit-transition:background-color 0.218s,border-color 0.218s;transition:background-color 0.218s,border-color 0.218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;-webkit-flex-direction:row;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:space-between;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;-webkit-box-flex:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;-webkit-box-flex:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color 0.218s;transition:background-color 0.218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><link id="googleidentityservice" type="text/css" media="all" href="https://accounts.google.com/gsi/style" rel="stylesheet"><meta http-equiv="origin-trial" content="A8o5T4MyEkRZqLA9WeG2XTFdV5tsX2Prg85xyQ+RL1btVuybB1K/EQ+7JUsPK+J32oBMTnsoF9B4A+qTlL6efgQAAABweyJvcmlnaW4iOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkZlZENtQnV0dG9uTW9kZSIsImV4cGlyeSI6MTc0NDY3NTIwMCwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="></head><body><div id="root"><div class="a b c"><a href="/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="du ah dv bf al b an ao ap aq ar as at au t v x j e r dw ab" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe0a6ca3f9502&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;%7Estage=mobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae"><div class="ac r af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="av aw ax"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ay i"><div class="ac aj az ba bb r bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bn bo ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="aj be bf bg ab bh bi bj bk bl" placeholder="Search" value=""></div></div></div><div class="i l x fi fj"><div class="fk ac"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt m">Write</div></div></a></span></div></div><div class="l k j e"><div class="fk ac"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fk i l k"><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m" aria-hidden="false"><button class="aj fp an ac r ap fl fq fr fs" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fl"><img alt="" class="m fd bx by bz cx" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:40:40/1*dmbNkD5D-u45r44go_cf0g.png"><div class="ft bx m by bz fu o aj fv"></div></div></button></div></div></div><div class="ac"><div class="ca bh" style=""><div class="m"><div><div class="ga bh m"><div class="gb bh bj"></div><div class="ac cb"><div class="cc cd ce cf cg gc ci bh"><div class="ae ac r"><div class="gd ge gf gg gh m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.com/google-cloud?source=post_page---publication_nav-e52cf94d98af-e0a6ca3f9502---------------------------------------" rel="noopener follow"><h2 class="bf gi gj dy gk gl ea gm gn go gp gq gr gs gt gu gv bk"><div class="fw fx fy fz">Google Cloud - Community</div></h2></a></div><div class="t v k j e"><span class="gw gx" aria-hidden="true"><span class="bf b gy gz bk">¬∑</span></span><p class="bf b gy gz bk"><span data-dd-action-name="Susi presentation tracker publication_nav"><a class="ag ah ai fh ak al am an ao ap aq ar as ps" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fgoogle-cloud&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;collection=Google+Cloud+-+Community&amp;collectionId=e52cf94d98af&amp;source=post_page---publication_nav-e52cf94d98af-e0a6ca3f9502---------------------publication_nav------------------" data-discover="true">Follow publication</a></span></p></div></div></div></div></div></div><div class="uj" role="dialog" aria-modal="true" tabindex="-1"><div class="xi xj bh dw xk xl xm ap hf ha xn" aria-hidden="true" role="presentation"></div><div class="xo xk xp xq xr xi dw fd xs xt xu nc xv xw xx xy xz ya yb yc yd ye ac co yf" aria-hidden="true"><div class="yg ib"></div></div></div><div class="ha fu hb hc o hd he nc aik"><div class="ac cb"><div class="cc cd ce cf cg gc ci bh"><div class="hh m"><div class="yi"><div class="ac cn co"><a href="https://medium.com/google-cloud?source=post_page---post_publication_sidebar-e52cf94d98af-e0a6ca3f9502---------------------------------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m hk hj" width="38" height="38" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m hj hk fu o ft hl"></div></div></a><div class="hm m"></div><p class="bf b bg ab du"><span class="hn">A collection of technical articles and blogs published or curated by Google Cloud Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.</span></p><div class="hm m"></div><p class="bf b bg ab bk"><span data-dd-action-name="Susi presentation tracker post_publication_sidebar"><a class="ag ah ai fh ak al am an ao ap aq ar as ps" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fgoogle-cloud&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;collection=Google+Cloud+-+Community&amp;collectionId=e52cf94d98af&amp;source=post_page---post_publication_sidebar-e52cf94d98af-e0a6ca3f9502---------------------post_publication_sidebar------------------" data-discover="true">Follow publication</a></span></p></div></div></div></div></div></div><div class="ho hp hq hr hs m"><div class="ac cb"><div class="ci bh ht hu hv hw"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fu ic yj ie if ha"></div><div class="speechify-ignore og oh sf fl i l k j acq"><aside class="xr fu o" style="width: 704px;"><div class="ada fw fu ail fz bh ac r adc"><p class="bf b dv ab du"><span>Top highlight</span></p></div></aside></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><div><h1 id="e724" class="pw-post-title ik il im bf in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bk" data-testid="storyTitle" data-selectable-paragraph=""><strong class="am">BigQuery WINDOW Functions | Advanced Techniques for Data Professionals</strong></h1></div><div><h2 id="a4f6" class="pw-subtitle-paragraph jj il im bf b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy cq du" data-selectable-paragraph="">A complete guide for maximizing the potential of BigQuery window functions to manipulate and transform data.</h2><div><div class="speechify-ignore ac cp"><div class="speechify-ignore bh m"><div class="ac jz ka kb kc kd ke kf kg kh ki kj"><div class="ac r kj"><div class="ac kk"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="be"><a rel="noopener follow" href="/@axel-thevenot?source=post_page---byline--e0a6ca3f9502---------------------------------------" data-discover="true"><div class="m kl km bx kn ko"><div class="m fl"><img alt="Axel Thevenot üê£" class="m fd bx by bz cx" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:40:40/1*hOsGwzYlwIq_FnMC-mBk8Q.jpeg"><div class="kp bx m by bz fu o kq fv"></div></div></div></a></div></div></div></div><span class="bf b bg ab bk"><div class="kr ac r"><div class="ac r ks"><div class="ac r"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="2" aria-labelledby="2"><div tabindex="-1" class="be"><span class="bf b bg ab bk"><a class="ag ah ai fh ak al am an ao ap aq ar as kt" data-testid="authorName" rel="noopener follow" href="/@axel-thevenot?source=post_page---byline--e0a6ca3f9502---------------------------------------" data-discover="true">Axel Thevenot üê£</a></span></div></div></div></div><div class="ku bm"></div><button class="wm abn ap ac cb r act acu acv" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm acw">Follow</span></span></button></div></div></span></div><div class="ac r kv"><span class="bf b bg ab du"><div class="ac af"><span data-testid="storyReadTime">13 min read</span><div class="kw kx m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bf b bg ab du">¬∑</span></span></div><span data-testid="storyPublishDate">Jan 9, 2023</span></div></span></div></div><div class="ac cp ky kz la lb lc ld le lf lg lh li lj lk ll lm ln"><div class="i l x fi fj r"><div class="md m"><div class="ac r me mf"><div class="pw-multi-vote-icon fl mg mh mi mj"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fgoogle-cloud%2Fe0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;user=Axel+Thevenot+%F0%9F%90%A3&amp;userId=a8fcc1458e87&amp;source=---header_actions--e0a6ca3f9502---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="3" aria-labelledby="3"><div tabindex="-1" class="be"><div class="mk ap ml mm mn mo an mp mq mr mj" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m ms mt mu mv mw mx my"><div><div class="bm" aria-hidden="false" aria-describedby="89" aria-labelledby="89" role="tooltip"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au acx nh">464<span class="m i h g uo up"></span></button></p></div></div></div></div></div></div><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="4" aria-labelledby="4"><div tabindex="-1" class="be"><button class="ap mk nc nd ac r fm ne nf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du"><span class="pw-responses-count na nb">2</span></p></button></div></div></div></div><div class="ac r lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc"><div class="ng l k j e"></div><div class="i l"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="5" aria-labelledby="5"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=---header_actions--e0a6ca3f9502---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="fd ni cn"><div class="m af"><div class="ac cb"><div class="nj nk nl nm nn fw ci bh"><div class="ac"><span data-dd-action-name="Susi presentation tracker post_audio_button"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3De0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=---header_actions--e0a6ca3f9502---------------------post_audio_button------------------" data-discover="true"><div><div class="bm" aria-hidden="false" aria-describedby="58" aria-labelledby="58" role="tooltip"><div tabindex="-1" class="be"><button aria-label="Listen" data-testid="audioPlayButton" class="ag fm ai fh ak al am no ao ap aq ex np nq nf nr ns nt nu nv t nw nx ny nz oa ob oc v od oe of"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bf b bg ab du">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="7" aria-labelledby="7"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag fm ai fh ak al am no ao ap aq ex np nq nf nr ns nt nu nv t nw nx ny nz oa ob oc v od oe of"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bf b bg ab du">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFnqJT_pzovNPxnBtLuEQg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*YFnqJT_pzovNPxnBtLuEQg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YFnqJT_pzovNPxnBtLuEQg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YFnqJT_pzovNPxnBtLuEQg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YFnqJT_pzovNPxnBtLuEQg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YFnqJT_pzovNPxnBtLuEQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YFnqJT_pzovNPxnBtLuEQg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YFnqJT_pzovNPxnBtLuEQg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*YFnqJT_pzovNPxnBtLuEQg.png"></picture></div></div></figure><p id="30cd" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">BigQuery is a <strong class="pb in">fully managed</strong> data warehouse that uses Google‚Äôs infrastructure that allows fast processing of SQL queries. It is especially useful for <strong class="pb in">analyzing</strong>, <strong class="pb in">exploring</strong>, and <strong class="pb in">visualizing</strong> large amounts of data.</p><p id="9295" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">This article <strong class="pb in">simplifies and helps to visualize</strong> the concepts of windows in Google Cloud for non-developers, as they can be challenging to understand despite the <strong class="pb in">very comprehensive</strong> <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls" rel="noopener ugc nofollow" target="_blank">documentation</a>.</p><p id="7e62" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In this guide, we will examine the <strong class="pb in">windows functions</strong> (also named <strong class="pb in">analytic</strong> functions) in BigQuery and learn how to effectively utilize them for <strong class="pb in">data analysis and manipulation</strong>.</p><blockquote class="pt pu pv"><p id="1339" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Summary<br></strong>Introduction<br>Basic syntax and usage of windows functions<br>Key components of a window declaration<br>Common windows functions in BigQuery<br>Advanced window declaration: the window frame clause<br>Named windows<br>The QUALIFY clause<br>Tips and best practices for using windows functions in BigQuery<br>Conclusion</p></blockquote><p id="18d8" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">[Looking for more BigQuery insights? Check out </strong><a class="ag ps" href="http://bit.ly/LyticsBQ" rel="noopener ugc nofollow" target="_blank"><strong class="pb in">Built with BigQuery: Lytics launches secure data sharing and enrichment solution on Google Cloud</strong></a><strong class="pb in">.]</strong></p></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="1e9e" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Basic syntax and usage of windows functions</h1><p id="431d" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">Window or analytic functions in BigQuery enable <strong class="pb in">advanced data manipulation</strong> and transformation. They allow you to perform calculations <strong class="pb in">over a set of rows related to the current row</strong>.</p><p id="45d1" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">With a window function, it is possible to perform calculations on rows <strong class="pb in">within</strong> a result set, such as <strong class="pb in">averaging</strong> or <strong class="pb in">ranking</strong>, while keeping the individual values of those rows.</p><blockquote class="rd"><p id="e980" class="re rf im bf rg rh ri rj rk rl rm pr du" data-selectable-paragraph="">You can work with values and aggregated values at the same time because the rows are not combined or merged.</p></blockquote><p id="4a9f" class="pw-post-body-paragraph oz pa im pb b jk rn pd pe jn ro pg ph gn rp pj pk gq rq pm pn gt rr pp pq pr hn bk" data-selectable-paragraph="">To use a window function in a query, you need to specify the function you want to use, <strong class="pb in">followed</strong> by the <code class="cx rs rt ru rv b">OVER()</code> clause, which determines the rows to apply the function to.</p><blockquote class="pt pu pv"><p id="6302" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> the details of the <code class="cx rs rt ru rv b">OVER()</code> clause will be covered in the next part.</p></blockquote><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="4a00" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span> <br>  customer_id, <br>  sales_amount,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> customer_id) <span class="hljs-keyword">AS</span> total_sales_per_customer<br><span class="hljs-keyword">FROM</span> sales</span></pre><p id="7517" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">It may appear similar to a query with a <code class="cx rs rt ru rv b">GROUP BY</code> like below, but the difference is significant.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="bd77" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span> <br>  customer_id, <br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">AS</span> total_sales_per_customer<br><span class="hljs-keyword">FROM</span> sales<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <br>  customer_id</span></pre><p id="e314" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">So what is the difference between using <code class="cx rs rt ru rv b">GROUP BY</code> and windows?</p><p id="b8ce" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">For a simple aggregation function, the main difference between using <code class="cx rs rt ru rv b">GROUP BY</code> and windows is the <strong class="pb in">scope of the function</strong>.</p><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*TwUVYBt8RQ-Bs9Ih_42y_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*TwUVYBt8RQ-Bs9Ih_42y_A.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="8f19" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><mark class="acr acs ap">While </mark><mark class="acr acs ap"><code class="cx rs rt ru rv b">GROUP BY</code></mark><mark class="acr acs ap"> is used to group rows and apply a function </mark><mark class="acr acs ap"><strong class="pb in">to each group</strong></mark><mark class="acr acs ap">, a window is used to apply a function </mark><mark class="acr acs ap"><strong class="pb in">to each individual row</strong></mark><mark class="acr acs ap">.</mark></p></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="30c6" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Key components of a window declaration</h1><p id="051b" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">This section introduces how to <strong class="pb in">define your window</strong>. In other words, how to declare your <code class="cx rs rt ru rv b">OVER()</code> clause. Advanced window declarations will be covered in a later section. Right now, we will focus on the two main components of the <code class="cx rs rt ru rv b">OVER()</code> clause: <code class="cx rs rt ru rv b">PARTITION BY</code> and <code class="cx rs rt ru rv b">ORDER BY</code>.</p><h2 id="cd8d" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">PARTITION BY</h2><p id="4c09" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">PARTITION BY</code> expression is easy to understand. It simply <strong class="pb in">breaks up</strong> the rows <strong class="pb in">into separate chunks </strong>(<strong class="pb in">partitions</strong>). The window function is then independently evaluated over each of these partitions.</p><p id="2650" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">You can even use <strong class="pb in">multiple expressions</strong> to partition on multiple fields at once. Let‚Äôs see an example to clarify things.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="ac8f" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  score,<br>  grade,<br>  <span class="hljs-built_in">AVG</span>(score) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name)        <span class="hljs-keyword">AS</span> average_score,<br>  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)   <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name, grade) <span class="hljs-keyword">AS</span> number_same_grade<br><span class="hljs-keyword">FROM</span> students</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wX_kNoHvXM7F5IMVG8R8OQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wX_kNoHvXM7F5IMVG8R8OQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wX_kNoHvXM7F5IMVG8R8OQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wX_kNoHvXM7F5IMVG8R8OQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wX_kNoHvXM7F5IMVG8R8OQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wX_kNoHvXM7F5IMVG8R8OQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wX_kNoHvXM7F5IMVG8R8OQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wX_kNoHvXM7F5IMVG8R8OQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*wX_kNoHvXM7F5IMVG8R8OQ.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="2ff5" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In this example, we can find the average score for each student by creating a <strong class="pb in">unique partition for each student</strong>. Similarly, we can create partitions for each student and letter grade to count them globally.</p><blockquote class="pt pu pv"><p id="15d3" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note: </strong>If <code class="cx rs rt ru rv b">PARTITION BY</code> is not specified, all the rows will be considered.</p></blockquote><h2 id="2d44" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">ORDER BY</h2><p id="bbcb" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">ORDER BY</code> clause determines the <strong class="pb in">arrangement</strong> of the rows <strong class="pb in">within each partition</strong>. If no <code class="cx rs rt ru rv b">ORDER BY</code> clause is specified, the order of the rows within each partition is <strong class="pb in">undefined</strong>.</p><blockquote class="pt pu pv"><p id="ef4f" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> You can also use multiple expressions here. If the first expression is equal between two rows, it will compare the second one, and so on.</p></blockquote><p id="4e83" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The major benefit of the <code class="cx rs rt ru rv b">ORDER BY</code> clause is that it creates a <strong class="pb in">sliding window</strong> from the first to the current row (by default).</p><p id="1177" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Here is an example of a <strong class="pb in">cumulative sum</strong> using this clause.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="1be5" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  product_name, <br>  sales_date,<br>  sales_amount,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sales_date)                           <span class="hljs-keyword">AS</span> cumulative_sales,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> product_name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sales_date) <span class="hljs-keyword">AS</span> cumulative_product_sales,<br><span class="hljs-keyword">FROM</span> sales</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F71EXQHoix9JtbYMJvGhfg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*F71EXQHoix9JtbYMJvGhfg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*F71EXQHoix9JtbYMJvGhfg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*F71EXQHoix9JtbYMJvGhfg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*F71EXQHoix9JtbYMJvGhfg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*F71EXQHoix9JtbYMJvGhfg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*F71EXQHoix9JtbYMJvGhfg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*F71EXQHoix9JtbYMJvGhfg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*F71EXQHoix9JtbYMJvGhfg.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="58de" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Do you notice anything strange in the <code class="cx rs rt ru rv b">cumulative_sale</code> feature for 2022‚Äì12‚Äì23 and 2022‚Äì12‚Äì24?</p><p id="f44d" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">I mentioned earlier that the <code class="cx rs rt ru rv b">ORDER BY</code> statement creates a sliding window from the first to the current row. However, for aggregation functions, <strong class="pb in">rows with equal values are included with the current row</strong>.</p><p id="b8c0" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">So their order is <strong class="pb in">undefined</strong>.</p><p id="49d7" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">To fix this issue, you can simply add the <code class="cx rs rt ru rv b">product_name</code> in the expressions. Easy peasy!</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="8064" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  product_name, <br>  sales_date,<br>  sales_amount,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sales_date, product_name)             <span class="hljs-keyword">AS</span> cumulative_sales,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> product_name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sales_date) <span class="hljs-keyword">AS</span> cumulative_product_sales,<br><span class="hljs-keyword">FROM</span> sales</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52FEQLhyU6OtRjAE-0ZXhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*52FEQLhyU6OtRjAE-0ZXhg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*52FEQLhyU6OtRjAE-0ZXhg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*52FEQLhyU6OtRjAE-0ZXhg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*52FEQLhyU6OtRjAE-0ZXhg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*52FEQLhyU6OtRjAE-0ZXhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*52FEQLhyU6OtRjAE-0ZXhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*52FEQLhyU6OtRjAE-0ZXhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*52FEQLhyU6OtRjAE-0ZXhg.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><blockquote class="pt pu pv"><p id="481d" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> If <code class="cx rs rt ru rv b"><em class="im">ORDER BY</em></code> is not specified, all the rows will be considered within the partition.</p></blockquote></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="e379" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Common windows functions in BigQuery</h1><p id="bf2b" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">In this section, we will cover three types of functions that can be used within a partition: <strong class="pb in">aggregation</strong>, <strong class="pb in">numbering</strong>, and <strong class="pb in">navigation</strong> functions.</p><h2 id="f162" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">Aggregation functions</h2><p id="9e94" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">Speaking of aggregation functions, I am sure you already are familiar with them as you probably use them <strong class="pb in">regularly</strong>. These functions include <code class="cx rs rt ru rv b">AVG()</code>, <code class="cx rs rt ru rv b">COUNT()</code>, <code class="cx rs rt ru rv b">MAX()</code>, <code class="cx rs rt ru rv b">MIN()</code>, <code class="cx rs rt ru rv b">SUM()</code>.</p><p id="3c81" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">To refresh your memory, we learned in the last sections that we can compute:</p><ul class=""><li id="ccef" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph="">A <strong class="pb in">global aggregation</strong> value within the partition if no <code class="cx rs rt ru rv b">ORDER BY</code> is specified.</li><li id="bc1e" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">If we specify the <code class="cx rs rt ru rv b">ORDER BY</code> expression, we can compute a <strong class="pb in">cumulative aggregation</strong>.</li></ul><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="9361" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  score,<br>  exam_date,<br>  <span class="hljs-built_in">AVG</span>(score) <span class="hljs-keyword">OVER</span>()                   <span class="hljs-keyword">AS</span> global_average_score,<br>  <span class="hljs-built_in">AVG</span>(score) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> exam_date) <span class="hljs-keyword">AS</span> running_average_score<br><span class="hljs-keyword">FROM</span> students</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W5RVJ5Id86830FmLcqHMHw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*W5RVJ5Id86830FmLcqHMHw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*W5RVJ5Id86830FmLcqHMHw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*W5RVJ5Id86830FmLcqHMHw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*W5RVJ5Id86830FmLcqHMHw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*W5RVJ5Id86830FmLcqHMHw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*W5RVJ5Id86830FmLcqHMHw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*W5RVJ5Id86830FmLcqHMHw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*W5RVJ5Id86830FmLcqHMHw.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="cd6e" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">For more functions, check out the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/aggregate_functions" rel="noopener ugc nofollow" target="_blank">aggregation functions documentation</a>.</p><blockquote class="pt pu pv"><p id="bdde" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/statistical_aggregate_functions" rel="noopener ugc nofollow" target="_blank">Statistical aggregation functions</a> <strong class="pb in">are</strong> also supported. <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/approximate_aggregate_functions" rel="noopener ugc nofollow" target="_blank">Approximate aggregation functions</a> <strong class="pb in">are not</strong> supported.</p></blockquote><h2 id="df56" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">Numbering functions</h2><p id="d340" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">Numbering functions, as the name suggests, <strong class="pb in">generate a sequence of numbers</strong>. They assign numeric values to each row <strong class="pb in">based on its position within the specified window</strong>.</p><p id="2dca" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The three main numbering functions are:</p><ul class=""><li id="76ce" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph=""><code class="cx rs rt ru rv b">RANK()</code>: returns the <strong class="pb in">rank</strong> of each row <strong class="pb in">within the ordered partition</strong>. All rows with the same value receive the same rank.</li><li id="bea2" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph=""><code class="cx rs rt ru rv b">DENSE_RANK()</code>: same as the <code class="cx rs rt ru rv b">RANK()</code> function, but it <strong class="pb in">does not leave gaps between integers</strong> for subsequent rows with the same value.</li><li id="1405" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph=""><code class="cx rs rt ru rv b">ROW_NUMBER()</code>: assigns a <strong class="pb in">distinct</strong> sequential integer to each row. Unlike the other functions, it <strong class="pb in">does not </strong>require an <code class="cx rs rt ru rv b">ORDER BY</code> expression.</li></ul><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="8a09" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  score,<br>  <span class="hljs-built_in">ROW_NUMBER</span>()   <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_row_number,<br>  <span class="hljs-built_in">RANK</span>()         <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_rank,<br>  <span class="hljs-built_in">DENSE_RANK</span>()   <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_dense_rank,<br>  <span class="hljs-built_in">PERCENT_RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_percent_rank,<br>  <span class="hljs-built_in">CUME_DIST</span>()    <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_cumulative_distribution,<br>  <span class="hljs-built_in">NTILE</span>(<span class="hljs-number">2</span>)       <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> student_two_tiles<br><span class="hljs-keyword">FROM</span> students</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0OWNd0y0s3__zxni9sQkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*e0OWNd0y0s3__zxni9sQkg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*e0OWNd0y0s3__zxni9sQkg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*e0OWNd0y0s3__zxni9sQkg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*e0OWNd0y0s3__zxni9sQkg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*e0OWNd0y0s3__zxni9sQkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*e0OWNd0y0s3__zxni9sQkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*e0OWNd0y0s3__zxni9sQkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*e0OWNd0y0s3__zxni9sQkg.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><blockquote class="pt pu pv"><p id="2575" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> this example demonstrates the six numbering functions that are <strong class="pb in">currently</strong> available. Check out the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions" rel="noopener ugc nofollow" target="_blank">documentation</a> for more detail.</p></blockquote><h2 id="7621" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">Navigation functions</h2><p id="38c0" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">Navigation functions are used to navigate through a partition to <strong class="pb in">access a specific value from a previous or subsequent row within its partition</strong>.</p><p id="704e" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Let‚Äôs have an example of what can be achieved with navigation functions.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="3647" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary,<br>  fiscal_year,<br>  <span class="hljs-built_in">LAG</span>(salary)          <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> previous_salary,<br>  <span class="hljs-built_in">LEAD</span>(salary, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>)   <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> two_salary_after,<br>  <span class="hljs-built_in">FIRST_VALUE</span>(salary)  <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> first_salary,<br>  <span class="hljs-built_in">NTH_VALUE</span>(salary, <span class="hljs-number">3</span>) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> third_salary, <br>  <span class="hljs-built_in">LAST_VALUE</span>(salary)   <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> last_salary<br><span class="hljs-keyword">FROM</span> employees</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ga6uBMtFA2fsw_Sm14qIlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ga6uBMtFA2fsw_Sm14qIlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ga6uBMtFA2fsw_Sm14qIlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ga6uBMtFA2fsw_Sm14qIlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ga6uBMtFA2fsw_Sm14qIlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ga6uBMtFA2fsw_Sm14qIlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ga6uBMtFA2fsw_Sm14qIlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ga6uBMtFA2fsw_Sm14qIlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ga6uBMtFA2fsw_Sm14qIlA.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="0863" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In this example you can denote two types of navigation functions:</p><ul class=""><li id="fa12" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">LAG()</code> and <code class="cx rs rt ru rv b">LEAD()</code> functions allow to respectively access to the <strong class="pb in">preceding</strong> and <strong class="pb in">following</strong> row value in an ordered window frame. <br>It is possible to <strong class="pb in">skip</strong> more than one row by specifying an integer as a <strong class="pb in">second argument</strong>. Additionally, a <strong class="pb in">default value</strong> can be provided as a <strong class="pb in">third argument</strong> in case the desired row does not exist, rather than returning <code class="cx rs rt ru rv b">NULL</code>.</li><li id="33b8" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">FIRST_VALUE()</code>, <code class="cx rs rt ru rv b">LAST_VALUE()</code>, and <code class="cx rs rt ru rv b">NTH_VALUE()</code> are pretty straightforward to understand. They respectively returns the <strong class="pb in">first</strong>, <strong class="pb in">last</strong>, and <strong class="pb in">specified</strong> row value in an ordered window frame. <br>It is also possible to <strong class="pb in">ignore null values</strong> in these functions by using the <code class="cx rs rt ru rv b">IGNORE NULLS</code> expression. <em class="pw">example: </em><code class="cx rs rt ru rv b"><em class="pw">FIRST_VALUE(column IGNORE NULLS)</em></code></li></ul><p id="641d" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">As a reminder, as soon as you declare your <code class="cx rs rt ru rv b">ORDER BY</code> expression, it creates a sliding window (called a ‚Äú<strong class="pb in">window frame</strong>‚Äù) in the partition. This window frame <strong class="pb in">starts at the first row</strong> of the partition and <strong class="pb in">extends to the current row</strong> <strong class="pb in">by default</strong>.</p><p id="1481" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">So our <code class="cx rs rt ru rv b">LAST_VALUE()</code> function returns the current row value, which is not particularly useful in our case‚Ä¶</p><p id="4522" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Of course, <strong class="pb in">you can change this default behavior</strong>. This drives us to our next part.</p><blockquote class="pt pu pv"><p id="631c" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> you can also compute the <strong class="pb in">continuous or discrete percentile</strong> with the <code class="cx rs rt ru rv b">PERCENTILE_CONT()</code> and <code class="cx rs rt ru rv b">PERCENTILE_DISCT()</code> functions. <br>Check out the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/navigation_functions" rel="noopener ugc nofollow" target="_blank">navigation functions documentation</a> for more detail.</p></blockquote></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="ef86" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Advanced window declaration: the window frame clause</h1><p id="a6fc" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">The next step involves <strong class="pb in">customizing</strong> the window frame using a <strong class="pb in">window frame specification</strong>. This can help create a <strong class="pb in">rolling average</strong> or <strong class="pb in">grouping similar</strong> items together. <br>As an example, we can combine these two techniques.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="009e" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  income,<br>  amount,<br>  fiscal_year,<br>  <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">OVER</span>(<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year <br>    <span class="hljs-keyword">ROWS</span>  <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>) <span class="hljs-keyword">AS</span> sum_two_last_income,<br>  <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">OVER</span>(<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year <br>    <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>) <span class="hljs-keyword">AS</span> sum_two_last_year_income,<br>  <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">OVER</span>(<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year <br>    <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1</span> FOLLOWING <span class="hljs-keyword">AND</span> UNBOUNDED FOLLOWING) <span class="hljs-keyword">AS</span> sum_subsequent_income<br><span class="hljs-keyword">FROM</span> incomes</span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZCmzuqOwpcHHBJ8yZ8tEHw.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="d736" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In the first column, <code class="cx rs rt ru rv b">sum_two_last_income</code>, we are using a rolling sum to add up <strong class="pb in">the current row </strong>and<strong class="pb in"> the row immediately preceding it</strong>. <br>You can include more preceding rows by changing the value of <code class="cx rs rt ru rv b">1</code>.</p><blockquote class="pt pu pv"><p id="e56e" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Note: <code class="cx rs rt ru rv b">CURRENT ROW</code> is also equivalent to <code class="cx rs rt ru rv b">0 PRECEDING</code> or <code class="cx rs rt ru rv b">0 FOLLOWING</code>.</p></blockquote><p id="aeda" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In the second column, <code class="cx rs rt ru rv b">sum_two_last_year_income</code>, we are performing a rolling sum <strong class="pb in">over the past two years rather than the past two rows</strong>.</p><p id="bc68" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">To specify this window frame, you can use:</p><ul class=""><li id="4745" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph="">the <code class="cx rs rt ru rv b">ROWS</code> expression to get the <strong class="pb in">physical rows</strong> around the current row.</li><li id="4be4" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">the <code class="cx rs rt ru rv b">RANGE</code> expression to get a <strong class="pb in">logical range of rows</strong> around the current row. There must be exactly one expression in the <code class="cx rs rt ru rv b">ORDER BY</code> clause, and the expression must have a numeric type.</li></ul><blockquote class="pt pu pv"><p id="aa86" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> you can use the<code class="cx rs rt ru rv b"><em class="im">UNIX_DATE()</em></code> to range with your date. Same for <code class="cx rs rt ru rv b"><em class="im">UNIX_SECONDS()</em></code>, <code class="cx rs rt ru rv b"><em class="im">UNIW_MILLIS()</em></code>, or <code class="cx rs rt ru rv b"><em class="im">UNIX_MICROS()</em></code> functions.</p></blockquote><p id="15ed" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The final example, <code class="cx rs rt ru rv b">sum_subsequent_income</code>, demonstrates how you can create a window that <strong class="pb in">starts after</strong> the current row <strong class="pb in">and excludes</strong> the current row. The same is possible for preceding rows as well.</p><h2 id="4be6" class="si qf im bf qg gj sj dy gk gl sk ea gm gn sl go gp gq sm gr gs gt sn gu gv so bk" data-selectable-paragraph="">Default behavior window frame</h2><ul class=""><li id="ac2c" class="oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr sp sq sr bk" data-selectable-paragraph="">If the <code class="cx rs rt ru rv b">ORDER BY</code> expression is not specified, the default window frame specification is <code class="cx rs rt ru rv b">ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code>.</li><li id="83be" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">If the <code class="cx rs rt ru rv b">ORDER BY</code> clause is specified and you use an aggregation function, the default window frame specification is <code class="cx rs rt ru rv b">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>.</li></ul><blockquote class="pt pu pv"><p id="0329" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> it is not possible to use a window frame specification with <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions" rel="noopener ugc nofollow" target="_blank">numbering functions</a>, and it is only supported for the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/navigation_functions" rel="noopener ugc nofollow" target="_blank">navigation functions</a> <code class="cx rs rt ru rv b"><em class="im">FIRST_VALUE()</em></code>, <code class="cx rs rt ru rv b"><em class="im">NTH_VALUE()</em></code>, and <code class="cx rs rt ru rv b"><em class="im">LAST_VALUE()</em></code>.</p><p id="2cdf" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Sub-Note:</strong> For other functions, the <code class="cx rs rt ru rv b">ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code> can be considered instead, even if you can not modify it.</p><p id="f1e1" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Check out the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls#def_window_frame" rel="noopener ugc nofollow" target="_blank">window frame specification documentation</a> for more detail.</p></blockquote></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="c4a9" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Named WINDOWs</h1><p id="24cc" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">In BigQuery, a window can be either <strong class="pb in">named</strong> or <strong class="pb in">unnamed</strong>.</p><p id="89e2" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">An unnamed window is <strong class="pb in">defined</strong> <strong class="pb in">in</strong> the <code class="cx rs rt ru rv b">OVER()</code> clause and is only used for the preceding aggregation, numbering, or navigation function. For example:</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="de1d" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary,<br>  fiscal_year,<br>  <span class="hljs-built_in">LAG</span>(salary)         <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> previous_salary,<br>  <span class="hljs-built_in">FIRST_VALUE</span>(salary) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> first_salary,<br>  <span class="hljs-built_in">SUM</span>(salary)         <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> cumulative_sum_salary,<br>  <span class="hljs-built_in">AVG</span>(salary)         <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year) <span class="hljs-keyword">AS</span> cumulative_average_salary,<br>  <span class="hljs-built_in">SUM</span>(salary)         <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">2</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>) <span class="hljs-keyword">AS</span> three_years_sum_salary,<br><span class="hljs-keyword">FROM</span> employees</span></pre><p id="d329" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In this query, the window declarations <strong class="pb in">can not be used outside</strong> of the corresponding statement.</p><p id="4b32" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">However, a <strong class="pb in">named</strong> window can be defined and used in multiple statements. It is created by using the <code class="cx rs rt ru rv b">WINDOW</code> keyword, followed by a name and the window definition.</p><p id="d24b" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The named window can then be <strong class="pb in">referenced in</strong> a <code class="cx rs rt ru rv b">SELECT</code> statement, as shown in the example below.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="f9f7" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary,<br>  fiscal_year,<br>  <span class="hljs-built_in">LAG</span>(salary)         <span class="hljs-keyword">OVER</span>(yearly_ordered_employee)      <span class="hljs-keyword">AS</span> previous_salary,<br>  <span class="hljs-built_in">FIRST_VALUE</span>(salary) <span class="hljs-keyword">OVER</span>(yearly_ordered_employee)      <span class="hljs-keyword">AS</span> first_salary,<br>  <span class="hljs-built_in">SUM</span>(salary)         <span class="hljs-keyword">OVER</span>(yearly_ordered_employee)      <span class="hljs-keyword">AS</span> cumulative_sum_salary,<br>  <span class="hljs-built_in">AVG</span>(salary)         <span class="hljs-keyword">OVER</span>(yearly_ordered_employee)      <span class="hljs-keyword">AS</span> cumulative_average_salary,<br>  <span class="hljs-built_in">SUM</span>(salary)         <span class="hljs-keyword">OVER</span>(three_years_ordered_employee) <span class="hljs-keyword">AS</span> three_years_sum_salary,<br><span class="hljs-keyword">FROM</span> employees<br><span class="hljs-keyword">WINDOW</span> <br>  yearly_ordered_employee      <span class="hljs-keyword">AS</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year), <br>  three_years_ordered_employee <span class="hljs-keyword">AS</span> (yearly_ordered_employee <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">2</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>)</span></pre><p id="572f" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Using a named window has several advantages.</p><ul class=""><li id="1716" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph="">It can be used in multiple <code class="cx rs rt ru rv b">SELECT</code> statements, making it <strong class="pb in">easier to maintain and update</strong> your queries.</li><li id="042e" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">It can also make the query <strong class="pb in">more readable</strong> by <strong class="pb in">separating</strong> the window definition from the <code class="cx rs rt ru rv b">SELECT</code> statement and giving it <strong class="pb in">a descriptive name</strong>.</li></ul><p id="c39a" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">In the example given, the named window <code class="cx rs rt ru rv b">three_years_ordered_employee</code> is not created independently but rather <strong class="pb in">builds upon the previously</strong> defined <code class="cx rs rt ru rv b">yearly_ordered_employee</code> window.</p><p id="00af" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The same result can be done with the first <code class="cx rs rt ru rv b">employee</code> named window in the modified version of the query.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="d076" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>   [...]<br><span class="hljs-keyword">FROM</span> employees<br><span class="hljs-keyword">WINDOW</span> <br>  employee                     <span class="hljs-keyword">AS</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name),<br>  yearly_ordered_employee      <span class="hljs-keyword">AS</span> (employee <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> fiscal_year),<br>  three_years_ordered_employee <span class="hljs-keyword">AS</span> (yearly_ordered_employee <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">2</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>)</span></pre><p id="2085" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">It is possible to create a <strong class="pb in">named window as an extension of another</strong> named window, as long as you</p><ul class=""><li id="2823" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph=""><strong class="pb in">follow the proper order of the clauses</strong>: <code class="cx rs rt ru rv b">PARTITION BY</code> before <code class="cx rs rt ru rv b">ORDER BY</code>, and then <code class="cx rs rt ru rv b">RANGE</code> or <code class="cx rs rt ru rv b">ROWS</code>).</li><li id="ad87" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">do <strong class="pb in">not</strong> extend a named window <strong class="pb in">with another named window</strong>.</li></ul><blockquote class="pt pu pv"><p id="9d45" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> Check out the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls#ref_named_window" rel="noopener ugc nofollow" target="_blank">named window documentation</a> for more detail.</p></blockquote></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="2098" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">The QUALIFY clause</h1><p id="e01b" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">QUALIFY</code> clause can be used in a query with a window to <strong class="pb in">filter the results</strong>. It is <strong class="pb in">different</strong> from the <code class="cx rs rt ru rv b">WHERE</code> and <code class="cx rs rt ru rv b">HAVING</code>.</p><ul class=""><li id="375b" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">WHERE</code> clause is used to filter rows and is <strong class="pb in">applied to individual</strong> records.</li><li id="d414" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">HAVING</code> clause is used to filter rows <strong class="pb in">applied after a group</strong> of records has been specified.</li><li id="1e72" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">QUALIFY</code> clause is used to filter rows <strong class="pb in">applied after a window</strong> function result.</li></ul><p id="971c" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">So one of the primary purposes of the <code class="cx rs rt ru rv b">QUALIFY</code> clause is to limit the rows returned in a query based on the output of the window function.</p><p id="66f6" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">For example, you may use it to only return the<strong class="pb in"> top rows</strong> within a given window.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="0d1f" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary,<br>  <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rank_by_salary<br><span class="hljs-keyword">FROM</span> employees<br>QUALIFY rank_by_salary <span class="hljs-operator">&lt;=</span> <span class="hljs-number">5</span></span></pre><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-5GPJFq9nIMNPZ7B5myW0Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-5GPJFq9nIMNPZ7B5myW0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-5GPJFq9nIMNPZ7B5myW0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-5GPJFq9nIMNPZ7B5myW0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-5GPJFq9nIMNPZ7B5myW0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-5GPJFq9nIMNPZ7B5myW0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-5GPJFq9nIMNPZ7B5myW0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-5GPJFq9nIMNPZ7B5myW0Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*-5GPJFq9nIMNPZ7B5myW0Q.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="eaac" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The <code class="cx rs rt ru rv b">QUALIFY</code> clause in this example filters the results to only include employees with a <strong class="pb in">rank of 5 or lower</strong> according to their salary.</p><p id="09df" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">If you do not want to include the <code class="cx rs rt ru rv b">rank_by_salary</code> field in the output, you can define and filter using an inline, <strong class="pb in">unnamed and unaliased window</strong> in the <code class="cx rs rt ru rv b">QUALIFY</code> clause.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="a782" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary<br><span class="hljs-keyword">FROM</span> employees<br>QUALIFY <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">5</span></span></pre><p id="9d77" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">And even if a <strong class="pb in">named window</strong> does not contribute any value to the query in this particular case, it is still possible to reference it.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="a09a" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-keyword">SELECT</span><br>  name,<br>  salary<br><span class="hljs-keyword">FROM</span> employees<br>QUALIFY <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span>(greatest_salary) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">5</span><br><span class="hljs-keyword">WINDOW</span> greatest_salary <span class="hljs-keyword">AS</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>)</span></pre><p id="fd2e" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">Using the <code class="cx rs rt ru rv b">QUALIFY</code> clause <strong class="pb in">is the most effective way to deduplicate data</strong> in a BigQuery table. For more information on this topic, see my article linked below.</p><div class="sx sy sz ta tb tc"><a rel="noopener follow" href="/google-cloud/deduplication-in-bigquery-tables-a-comparative-study-of-7-approaches-f48966eeea2b?source=post_page-----e0a6ca3f9502---------------------------------------" target="_blank" data-discover="true"><div class="td ac te"><div class="tf ac co cb ca tg"><h2 class="bf in gy ab fx th fy ti tj tk tl il bk">Deduplication in BigQuery Tables: A Comparative Study of 7 Approaches</h2><div class="tm m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Analyzing and comparing 7 ways of deduplicating rows in a BigQuery table.</h3></div><div class="tn m"><p class="bf b dv ab fx th fy ti tj tk tl du">medium.com</p></div></div><div class="to m"><div class="xh m tq tr ts to tt fw tc"></div></div></div></a></div></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="3110" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Tips and best practices for using windows functions in BigQuery</h1><p id="aee9" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">There are several tips and best practices that can help you <strong class="pb in">optimize performance</strong> and <strong class="pb in">readability</strong> when using window functions in BigQuery. Here are a few to consider:</p><ul class=""><li id="f369" class="oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr sp sq sr bk" data-selectable-paragraph=""><strong class="pb in">Avoid unnecessary calculations</strong> by only including the columns and expressions that are necessary for your query (fewer columns). This can also help improve performance.</li><li id="8f53" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">Use <strong class="pb in">filters wherever possible</strong> to reduce the amount of data that the window function has to process (fewer rows). This can help <strong class="pb in">speed up </strong>your queries and <strong class="pb in">reduce resource usage and cost</strong>.</li><li id="76d8" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">If you have the option to use window functions instead of other methods to solve a problem, it is <strong class="pb in">often the most optimized</strong> way to do so in terms of both <strong class="pb in">performance</strong> and <strong class="pb in">readability</strong>.</li><li id="3eaa" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">It is a good idea to be <strong class="pb in">explicit</strong> when aliasing your columns and naming your windows. This can <strong class="pb in">help others understand</strong> your queries even if they are not familiar with the concept of windowing.</li><li id="d0cc" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">To <strong class="pb in">save time and avoid errors</strong>, it is helpful to have the <a class="ag ps" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls" rel="noopener ugc nofollow" target="_blank">documentation</a> on your side while writing your query, paying close attention to the <strong class="pb in">details</strong> and <strong class="pb in">syntax</strong>.</li><li id="655e" class="oz pa im pb b jk ss pd pe jn st pg ph gn su pj pk gq sv pm pn gt sw pp pq pr sp sq sr bk" data-selectable-paragraph="">Keep in mind the <strong class="pb in">order of clause execution</strong> in your queries. This can affect the results of your query, so it is important to understand the order in which the clauses are applied.</li></ul><p id="3590" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">To review the final point, it is important to understand that <strong class="pb in">the order in which a query is written does not determine the order in which it is executed</strong>.</p><p id="8d3b" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">As a fun way to illustrate this concept, here is the solution from a game we saw in our childhood.</p><figure class="oj ok ol om on oo og oh paragraph-image"><div role="button" tabindex="0" class="op oq fl or bh os"><span class="fu ot ou an ov fx ow fz ox speechify-ignore">Press enter or click to view image in full size</span><div class="og oh oi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*TPjMSAsT3zaoOUOJ4a2ZPg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw oy c" width="700" height="166" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*TPjMSAsT3zaoOUOJ4a2ZPg.png"></picture></div></div><figcaption class="se ff sf og oh sg sh bf b bg ab du" data-selectable-paragraph="">Image by author</figcaption></figure><p id="dafe" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">You note, the <code class="cx rs rt ru rv b">WHERE</code> clause <strong class="pb in">filters rows</strong>, which are <strong class="pb in">then aggregated </strong>and <strong class="pb in">further filtered</strong> using the <code class="cx rs rt ru rv b">HAVING</code> clause. Then the resulting rows can be processed using a window function and filtered again with the <code class="cx rs rt ru rv b">QUALIFY</code> clause.</p><p id="237a" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">For example, if you want to <strong class="pb in">filter the final </strong>rows <strong class="pb in">while also including other rows </strong>in the windowing operation, you should use the <code class="cx rs rt ru rv b">QUALIFY</code> clause instead of the <code class="cx rs rt ru rv b">WHERE</code> or <code class="cx rs rt ru rv b">HAVING</code>, or your result may be incorrect.</p><pre class="oj ok ol om on rw rv rx bp ry bb bk"><span id="4c3f" class="rz qf im rv b bg sa sb m sc sd" data-selectable-paragraph=""><span class="hljs-comment">/*<br>  Returns the daily sales of each fruit product <br>  as well as the global daily sales across all categories<br>*/</span><br><br><span class="hljs-keyword">SELECT</span><br>  sales_date,<br>  product_category,<br>  product_name,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> sales_date, product_name) <span class="hljs-keyword">AS</span> `category_day_sales`,<br>  <span class="hljs-built_in">SUM</span>(sales_amount) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> sales_date)               <span class="hljs-keyword">AS</span> `global_day_sales`,<br><span class="hljs-keyword">FROM</span> sales<br><span class="hljs-comment">-- WHERE product_category = 'fruit'</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <br>  product_category,<br>  product_name<br>QUALIFY product_category <span class="hljs-operator">=</span> <span class="hljs-string">'fruit'</span></span></pre><blockquote class="pt pu pv"><p id="6bb3" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph=""><strong class="pb in">Note:</strong> the <code class="cx rs rt ru rv b">QUALIFY</code> clause can filter rows that are not the result of a window function. It only is applied after the window function.</p></blockquote></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="fb1c" class="qe qf im bf qg qh qi jm gk qj qk jp gm ql qm qn qo qp qq qr qs qt qu qv qw qx bk" data-selectable-paragraph="">Conclusion</h1><p id="711a" class="pw-post-body-paragraph oz pa im pb b jk qy pd pe jn qz pg ph gn ra pj pk gq rb pm pn gt rc pp pq pr hn bk" data-selectable-paragraph="">BigQuery windows functions are a <strong class="pb in">powerful tool for data professionals</strong> looking to <strong class="pb in">manipulate</strong> and <strong class="pb in">transform</strong> data in new and innovative ways.</p><p id="dc92" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">With a <strong class="pb in">basic understanding</strong> of the <strong class="pb in">syntax</strong> and <strong class="pb in">usage</strong> of these functions, as well as an understanding of the key components of a window declaration, it is <strong class="pb in">possible to leverage the many common windows functions</strong> available in BigQuery to achieve a wide variety of results.</p><p id="cb84" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">The advanced <strong class="pb in">window frame specification</strong> and <strong class="pb in">named windows</strong> allow even <strong class="pb in">more flexibility and control.</strong> And the <code class="cx rs rt ru rv b">QUALIFY</code> clause can be used to further <strong class="pb in">filter the final results</strong> of a query for both windowing function outputs and previously computed results.</p><p id="2d1e" class="pw-post-body-paragraph oz pa im pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">By following some of the <strong class="pb in">tips and best practices</strong>, data professionals can improve the <strong class="pb in">performance</strong> and <strong class="pb in">readability</strong> of their queries.</p></div></div></div><div class="ac cb px py pz qa" role="separator"><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc qd"></span><span class="qb bx bm gb qc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><blockquote class="pt pu pv"><p id="645a" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">I hope this guide has been helpful and will help you take your data analysis to the next level.</p><p id="f0d5" class="oz pa pw pb b jk pc pd pe jn pf pg ph gn pi pj pk gq pl pm pn gt po pp pq pr hn bk" data-selectable-paragraph="">If you found it useful, <strong class="pb in">please consider giving it a few claps to show your support</strong>. üëè</p></blockquote></div></div></div></div></section></div></div></article></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="tu tv ac kv"><div class="tm ac"><a class="tw aj an ap" rel="noopener follow" href="/tag/data?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><div class="tx fl cx ty hy tz ua bf b bg ab bk fz">Data</div></a></div><div class="tm ac"><a class="tw aj an ap" rel="noopener follow" href="/tag/bigquery?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><div class="tx fl cx ty hy tz ua bf b bg ab bk fz">Bigquery</div></a></div><div class="tm ac"><a class="tw aj an ap" rel="noopener follow" href="/tag/big-data?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><div class="tx fl cx ty hy tz ua bf b bg ab bk fz">Big Data</div></a></div><div class="tm ac"><a class="tw aj an ap" rel="noopener follow" href="/tag/sql?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><div class="tx fl cx ty hy tz ua bf b bg ab bk fz">Sql</div></a></div><div class="tm ac"><a class="tw aj an ap" rel="noopener follow" href="/tag/google-cloud-platform?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><div class="tx fl cx ty hy tz ua bf b bg ab bk fz">Google Cloud Platform</div></a></div></div><div class="ub nb m"><div class="gx"><div class="bm"><p class="bf b bg ab du"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="8" aria-labelledby="8"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt" href="https://creativecommons.org/publicdomain/mark/1.0/" rel="noopener follow" target="_blank">Public domain.</a></div></div></div></p></div><div class="bm"><p class="bf b bg ab du"><span class="fm" style="margin-left: 5px; vertical-align: text-bottom;"></span></p></div></div></div></div></div><div class="m"></div><footer class="uc ud ue uf ug ac r uh ui c"><div class="m af"><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ac cp uj"><div class="ac r me"><div class="uk m"><span class="m ul um un f e"><div class="ac r me mf"><div class="pw-multi-vote-icon fl mg mh mi mj"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fgoogle-cloud%2Fe0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;user=Axel+Thevenot+%F0%9F%90%A3&amp;userId=a8fcc1458e87&amp;source=---footer_actions--e0a6ca3f9502---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="9" aria-labelledby="9"><div tabindex="-1" class="be"><div class="mk ap ml mm mn mo an mp mq mr mj" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m ms mt mu mv mw mx my"><div><div class="bm" aria-hidden="false" aria-describedby="96" aria-labelledby="96" role="tooltip"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au acx nh">464<span class="m i h g uo up"></span></button></p></div></div></div></div></div></span><span class="m i h g uo up"><div class="ac r me mf"><div class="pw-multi-vote-icon fl mg mh mi mj"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fgoogle-cloud%2Fe0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;user=Axel+Thevenot+%F0%9F%90%A3&amp;userId=a8fcc1458e87&amp;source=---footer_actions--e0a6ca3f9502---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="10" aria-labelledby="10"><div tabindex="-1" class="be"><div class="mk ap ml mm mn mo an mp mq mr mj" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m ms mt mu mv mw mx my"><div><div class="bm" aria-hidden="false" aria-describedby="98" aria-labelledby="98" role="tooltip"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au acx nh">464</button></p></div></div></div></div></div></span></div><div class="ay ac"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="11" aria-labelledby="11"><div tabindex="-1" class="be"><button class="ap mk nc nd ac r fm ne nf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg ab du"><span class="pw-responses-count na nb">2</span></p></button></div></div></div></div></div><div class="ac r"><div class="qd m te"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="12" aria-labelledby="12"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a6ca3f9502&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=---footer_actions--e0a6ca3f9502---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="qd m te"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="13" aria-labelledby="13"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag fm ai fh ak al am no ao ap aq ex np nq nf nr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></footer><div class="uq m"><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ur m"><div class="ac ki kg ke us ut"><div class="uu uv uw ux uy uz va vb vc vd ac cp"><div class="i l"><a href="https://medium.com/google-cloud?source=post_page---post_publication_info--e0a6ca3f9502---------------------------------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m vf ve" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:60:60/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m ve vf fu o ft hl"></div></div></a></div><div class="k j e"><a href="https://medium.com/google-cloud?source=post_page---post_publication_info--e0a6ca3f9502---------------------------------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m vh vg" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:80:80/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m vg vh fu o ft hl"></div></div></a></div><div class="k j e vi te"><div class="ac"><button class="wm abn ap ac cb r acy md acz" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm acw">Follow</span></span></button></div></div></div><div class="ac co ca"><div class="vj vk vl vm vn m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" href="https://medium.com/google-cloud?source=post_page---post_publication_info--e0a6ca3f9502---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bf gi vp vq vr vs vt vu gn go gp gq gr gs gt gu gv bk"><span class="hn vo">Published in Google Cloud - Community</span></h2></a><div class="tm ac kk"><div class="m te"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kt" rel="noopener follow" href="/google-cloud/followers?source=post_page---post_publication_info--e0a6ca3f9502---------------------------------------" data-discover="true">67K followers</a></span></div><div class="bf b bg ab du ac vv"><span class="gw m" aria-hidden="true"><span class="bf b bg ab du">¬∑</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kt" rel="noopener follow" href="/google-cloud/the-silent-killer-of-developer-flow-how-ai-just-brought-your-database-home-bf454441e886?source=post_page---post_publication_info--e0a6ca3f9502---------------------------------------" data-discover="true">Last published&nbsp;23 hours ago</a></div></div><div class="hm m"><p class="bf b bg ab bk"><span class="hn">A collection of technical articles and blogs published or curated by Google Cloud Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.</span></p></div></div></div><div class="i l"><div class="ac"><button class="wm abn ap ac cb r acy md acz" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm acw">Follow</span></span></button></div></div></div></div><div class="ac ki kg ke us ut"><div class="uu uv uw ux uy uz va vb vc vd ac cp"><div class="i l"><a tabindex="0" rel="noopener follow" href="/@axel-thevenot?source=post_page---post_author_info--e0a6ca3f9502---------------------------------------" data-discover="true"><div class="m fl"><img alt="Axel Thevenot üê£" class="m fd bx ve vf cx" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:60:60/1*hOsGwzYlwIq_FnMC-mBk8Q.jpeg"><div class="ft bx m ve vf fu o aj hl"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="/@axel-thevenot?source=post_page---post_author_info--e0a6ca3f9502---------------------------------------" data-discover="true"><div class="m fl"><img alt="Axel Thevenot üê£" class="m fd bx vg vh cx" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:80:80/1*hOsGwzYlwIq_FnMC-mBk8Q.jpeg"><div class="ft bx m vg vh fu o aj hl"></div></div></a></div><div class="k j e vi te"><div class="ac"><button class="wm abn ap ac cb r acy md acz" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm acw">Follow</span></span></button></div></div></div><div class="ac co ca"><div class="vj vk vl vm vn m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" rel="noopener follow" href="/@axel-thevenot?source=post_page---post_author_info--e0a6ca3f9502---------------------------------------" data-discover="true"><h2 class="pw-author-name bf gi vp vq vr vs vt vu gn go gp gq gr gs gt gu gv bk"><span class="hn vo">Written by Axel Thevenot üê£</span></h2></a><div class="tm ac kk"><div class="m te"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kt" rel="noopener follow" href="/@axel-thevenot/followers?source=post_page---post_author_info--e0a6ca3f9502---------------------------------------" data-discover="true">1.4K followers</a></span></div><div class="bf b bg ab du ac vv"><span class="gw m" aria-hidden="true"><span class="bf b bg ab du">¬∑</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kt" rel="noopener follow" href="/@axel-thevenot/following?source=post_page---post_author_info--e0a6ca3f9502---------------------------------------" data-discover="true">69 following</a></div></div><div class="hm m"><p class="bf b bg ab bk">Lead Data Engineer | <a class="ag ah ai fh ak al am an ao ap aq ar as ps ig hn" href="http://www.linkedin.com/in/axel-thevenot" rel="noopener  ugc nofollow">www.linkedin.com/in/axel-thevenot</a> | <a class="ag ah ai fh ak al am an ao ap aq ar as ps ig hn" href="mailto:axel.thevenot.pro@gmail.com" rel="noopener  ugc nofollow">axel.thevenot.pro@gmail.com</a></p></div></div></div><div class="i l"><div class="ac"><button class="wm abn ap ac cb r acy md acz" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm acw">Follow</span></span></button></div></div></div></div></div></div><div class="vw vx vy vz wa m"><div class="wb bh s uq"></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ac r cp"><h2 class="bf gi qh jm gk qj jp gm ql qn qo qp qr qs qt qv qw bk">Responses (2)</h2><div class="ac wc"><div><div class="bm" aria-hidden="false" role="tooltip" aria-describedby="14" aria-labelledby="14"><div tabindex="-1" class="be"><a class="wd we" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--e0a6ca3f9502---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="wf ga wg wh wi wj wk m"><div><div class="bf b bg ab bk"><div class="gz"><div class="ace m"><div class="acf ac r"><div class="m fl"><img alt="" class="m fd bx by bz cx" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:40:40/1*dmbNkD5D-u45r44go_cf0g.png"><div class="ft bx m by bz fu o aj hl"></div></div><div class="bn ac cn co cb"><p class="bf b bg ab du">Write a response</p></div></div><div class="cx bp ac co abx aby"><div class="ac co fl"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502&amp;source=---post_responses--e0a6ca3f9502---------------------respond_sidebar------------------" data-discover="true"><div class="acg m"><p class="bf b bg ab du">What are your thoughts?</p></div></a></span><div class="cp abz du ac aca hf acb"><span class="bf b bg ab du"><div class="ac"><div><div class="bm" aria-hidden="false" aria-describedby="29" aria-labelledby="29" role="tooltip"><div tabindex="-1" class="be"><span role="button" aria-label="Bold (‚åòB)" class="ach aci acj ack bp ni cb acl acm acn" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bm" aria-hidden="false" aria-describedby="30" aria-labelledby="30" role="tooltip"><div tabindex="-1" class="be"><span role="button" aria-label="Italic (‚åòI)" class="ach aci acj ack bp ni cb acl acm acn" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="acc vi ac aca hf acb"><div class="acd"><button class="bf b dv ab bk aco wl wm wn nh ne wo ev ew ex wp wq wr fa fb fc fd bm fe ff" data-testid="CancelResponseButton">Cancel</button></div><button class="bf b dv ab abp aco abq abr abs abt wo ev ew abu abv abw fa fb fc fd bm fe ff" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div><div class="ga m"><div class="bh dw"><div class="add ade m"><div class="ac cp"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="108" aria-labelledby="108" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/@carlogoes74?source=post_page---post_responses--e0a6ca3f9502----0-----------------------------------" data-discover="true"><div class="m fl"><div class="m fl"><img alt="Carlo Goes" class="m fd bx by bz cx" width="32" height="32" loading="lazy" src="https://miro.medium.com/v2/resize:fill:40:40/1*aEHyjNkKV699hjM0-B9hJg.png"><div class="ft bx m by bz fu o aj fv"></div></div></div></a></div></div></div><div class="adf m"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="109" aria-labelledby="109" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au ac r adg adh" rel="noopener follow" href="/@carlogoes74?source=post_page---post_responses--e0a6ca3f9502----0-----------------------------------" data-discover="true"><div class="ac kk adg"><p class="bf b bg ab fx adi fy ti adj tk adk tl bk">Carlo Goes</p></div></a></div></div></div></div><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/@carlogoes74/nice-article-the-qualify-clause-is-new-to-me-and-interesting-that-it-doesnt-exist-in-postgresql-ad56466a02d?source=post_page---post_responses--e0a6ca3f9502----0-----------------------------------" data-discover="true"><p class="bf b dv ab du"><span>May 22, 2023</span></p></a></div></div><div class="bm" aria-hidden="false"><button class="ag fm ai fh ak al am no ao ap aq ex np nq nf nr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="adl m hn"><pre class="vv"><div class="adm m"><div class="bf b bg ab bk"><div class="gz">Nice article! The QUALIFY clause is new to me and interesting that it doesn't exist in Postgresql</div></div></div></pre></div><div class="adn ac r me cp"><div class="ac r ado"><div class="ac r me mf"><div class="pw-multi-vote-icon fl mg mh mi mj"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fad56466a02d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40carlogoes74%2Fnice-article-the-qualify-clause-is-new-to-me-and-interesting-that-it-doesnt-exist-in-postgresql-ad56466a02d&amp;user=Carlo+Goes&amp;userId=b8db88a80c6&amp;source=---post_responses--ad56466a02d----0-----------------respond_sidebar------------------" data-discover="true"><div class="mk ap ml mm mn mo an mp mq mr mj" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div><div class="pw-multi-vote-count m ms mt mu mv mw mx my"><p class="bf b dv ab du">5</p></div></div><button class="ag fm ai fh ak al am an ao ap aq ar as at au ac r adg nh ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="responses"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du">2 replies</p></button><p class="bf b dv ab bk"><button class="ag ah ai fh ak al am an ao ap aq ar as ps">Reply</button></p></div></div></div></div></div><div class="ga m"><div class="bh dw"><div class="add ade m"><div class="ac cp"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="110" aria-labelledby="110" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/@guillaume-blaquiere?source=post_page---post_responses--e0a6ca3f9502----1-----------------------------------" data-discover="true"><div class="m fl"><div class="m fl"><img alt="guillaume blaquiere" class="m fd bx by bz cx" width="32" height="32" loading="lazy" src="https://miro.medium.com/v2/resize:fill:40:40/1*k6UC9pu9WPgg6pPGZWUtSw.png"><div class="ft bx m by bz fu o aj fv"></div></div></div></a></div></div></div><div class="adf m"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="111" aria-labelledby="111" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au ac r adg adh" rel="noopener follow" href="/@guillaume-blaquiere?source=post_page---post_responses--e0a6ca3f9502----1-----------------------------------" data-discover="true"><div class="ac kk adg"><p class="bf b bg ab fx adi fy ti adj tk adk tl bk">guillaume blaquiere</p></div></a></div></div></div></div><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://guillaume-blaquiere.medium.com/trop-bien-ca74b7af37e?source=post_page---post_responses--e0a6ca3f9502----1-----------------------------------" rel="noopener follow"><p class="bf b dv ab du"><span>Jan 10, 2023</span></p></a></div></div><div class="bm" aria-hidden="false"><button class="ag fm ai fh ak al am no ao ap aq ex np nq nf nr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="adl m hn"><pre class="vv"><div class="adm m"><div class="bf b bg ab bk"><div class="gz">Trop Bien!</div></div></div></pre></div><div class="adn ac r me cp"><div class="ac r ado"><div class="ac r me mf"><div class="pw-multi-vote-icon fl mg mh mi mj"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fca74b7af37e&amp;operation=register&amp;redirect=https%3A%2F%2Fguillaume-blaquiere.medium.com%2Ftrop-bien-ca74b7af37e&amp;user=guillaume+blaquiere&amp;userId=fcdb71c20074&amp;source=---post_responses--ca74b7af37e----1-----------------respond_sidebar------------------" data-discover="true"><div class="mk ap ml mm mn mo an mp mq mr mj" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div><div class="pw-multi-vote-count m ms mt mu mv mw mx my"><p class="bf b dv ab du">5</p></div></div><button class="ag fm ai fh ak al am an ao ap aq ar as at au ac r adg nh ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="responses"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du">1 reply</p></button><p class="bf b dv ab bk"><button class="ag ah ai fh ak al am an ao ap aq ar as ps">Reply</button></p></div></div></div></div></div></div></div></div><div class="wx wy wz xa xb m bw"><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="adp adq dm dn do hm m"><h2 class="bf gi qh jm gk qj jp gm ql qn qo qp qr qs qt qv qw bk">More from Axel Thevenot üê£ and Google Cloud - Community</h2></div><div class="abf ac me kv adr ads adt adu adv adw adx ady adz aea aeb aec aed aee aef"><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/google-cloud/efficient-bigquery-data-modeling-a-storage-and-compute-comparison-ca7f3744e467" tabindex="0"><div class="afr"><div aria-label="Efficient BigQuery Data Modeling: A Storage and Compute Comparison"><div class="aft afu afv afw acq"><img alt="Efficient BigQuery Data Modeling: A Storage and Compute Comparison" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*asO8vT4O51gx1ycYmn-kxA.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="135" aria-labelledby="135" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----0---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="136" aria-labelledby="136" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----0---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Google Cloud - Community</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="137" aria-labelledby="137" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@axel-thevenot?source=post_page---author_recirc--e0a6ca3f9502----0---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Axel Thevenot üê£</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/google-cloud/efficient-bigquery-data-modeling-a-storage-and-compute-comparison-ca7f3744e467?source=post_page---author_recirc--e0a6ca3f9502----0---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Efficient BigQuery Data Modeling: A Storage and Compute Comparison</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">BigQuery storage and compute comparison for normalized, denormalized, and nested design: an in-depth analysis with actionable optimizations</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>Mar 11, 2024</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/google-cloud/efficient-bigquery-data-modeling-a-storage-and-compute-comparison-ca7f3744e467?source=post_page---author_recirc--e0a6ca3f9502----0---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="199" aria-labelledby="199" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>720</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="138" aria-labelledby="138" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>23</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="139" aria-labelledby="139" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca7f3744e467&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fefficient-bigquery-data-modeling-a-storage-and-compute-comparison-ca7f3744e467&amp;source=---author_recirc--e0a6ca3f9502----0-----------------bookmark_preview----b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/google-cloud/model-context-protocol-mcp-with-google-gemini-llm-a-deep-dive-full-code-ea16e3fac9a3" tabindex="0"><div class="afr"><div aria-label="Model Context Protocol(MCP) with Google Gemini LLM‚Ää‚Äî‚ÄäA Deep Dive (Full Code)"><div class="aft afu afv afw acq"><img alt="Model Context Protocol(MCP) with Google Gemini LLM‚Ää‚Äî‚ÄäA Deep Dive (Full Code)" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*xXrGQq3-fXdRTv75Z0hkHg.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="140" aria-labelledby="140" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----1---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="141" aria-labelledby="141" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----1---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Google Cloud - Community</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="142" aria-labelledby="142" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@arjun-prabhulal?source=post_page---author_recirc--e0a6ca3f9502----1---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Arjun Prabhulal</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/google-cloud/model-context-protocol-mcp-with-google-gemini-llm-a-deep-dive-full-code-ea16e3fac9a3?source=post_page---author_recirc--e0a6ca3f9502----1---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div title="Model Context Protocol(MCP) with Google Gemini LLM‚Ää‚Äî‚ÄäA Deep Dive (Full Code)"><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Model Context Protocol(MCP) with Google Gemini LLM‚Ää‚Äî‚ÄäA Deep Dive (Full Code)</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">A step-by-step guide with code, architecture, and real-world use case</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>Apr 4</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/google-cloud/model-context-protocol-mcp-with-google-gemini-llm-a-deep-dive-full-code-ea16e3fac9a3?source=post_page---author_recirc--e0a6ca3f9502----1---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="201" aria-labelledby="201" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>1.1K</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="143" aria-labelledby="143" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>19</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="144" aria-labelledby="144" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea16e3fac9a3&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fmodel-context-protocol-mcp-with-google-gemini-llm-a-deep-dive-full-code-ea16e3fac9a3&amp;source=---author_recirc--e0a6ca3f9502----1-----------------bookmark_preview----b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/google-cloud/gemini-cli-tutorial-series-part-5-github-mcp-server-b557ae449e6e" tabindex="0"><div class="afr"><div aria-label="Gemini CLI Tutorial Series‚Ää‚Äî‚ÄäPart 5&nbsp;: Github MCP Server"><div class="aft afu afv afw acq"><img alt="Gemini CLI Tutorial Series‚Ää‚Äî‚ÄäPart 5&nbsp;: Github MCP Server" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*Y_V2M5Bny-FqiV4xTW5zOw.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="145" aria-labelledby="145" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----2---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="146" aria-labelledby="146" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502----2---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Google Cloud - Community</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="147" aria-labelledby="147" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@iromin?source=post_page---author_recirc--e0a6ca3f9502----2---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Romin Irani</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/google-cloud/gemini-cli-tutorial-series-part-5-github-mcp-server-b557ae449e6e?source=post_page---author_recirc--e0a6ca3f9502----2---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Gemini CLI Tutorial Series‚Ää‚Äî‚ÄäPart 5&nbsp;: Github MCP Server</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Welcome to Part 5 of the Gemini CLI Tutorial series.</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>Jul 11</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/google-cloud/gemini-cli-tutorial-series-part-5-github-mcp-server-b557ae449e6e?source=post_page---author_recirc--e0a6ca3f9502----2---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="203" aria-labelledby="203" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>84</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="148" aria-labelledby="148" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb557ae449e6e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fgemini-cli-tutorial-series-part-5-github-mcp-server-b557ae449e6e&amp;source=---author_recirc--e0a6ca3f9502----2-----------------bookmark_preview----b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/data-science/conv2d-to-finally-understand-what-happens-in-the-forward-pass-1bbaafb0b148" tabindex="0"><div class="afr"><div aria-label="Conv2d Understand Forward Pass visual math explain 2D convolution layer python arguments pytorch keras"><div class="aft afu afv afw acq"><img alt="Conv2d Understand Forward Pass visual math explain 2D convolution layer python arguments pytorch keras" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*DTTpGlhwkctlv9CYannVsw.gif"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="149" aria-labelledby="149" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/data-science?source=post_page---author_recirc--e0a6ca3f9502----3---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*JEuS4KBdakUcjg9sC7Wo4A.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="150" aria-labelledby="150" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/data-science?source=post_page---author_recirc--e0a6ca3f9502----3---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">TDS Archive</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="151" aria-labelledby="151" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@axel-thevenot?source=post_page---author_recirc--e0a6ca3f9502----3---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Axel Thevenot üê£</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/data-science/conv2d-to-finally-understand-what-happens-in-the-forward-pass-1bbaafb0b148?source=post_page---author_recirc--e0a6ca3f9502----3---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Conv2d: Finally Understand What Happens in the Forward Pass</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Visual and mathematical explanation of the 2D convolution layer and its arguments</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>May 1, 2020</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/data-science/conv2d-to-finally-understand-what-happens-in-the-forward-pass-1bbaafb0b148?source=post_page---author_recirc--e0a6ca3f9502----3---------------------b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="204" aria-labelledby="204" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>1.2K</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="152" aria-labelledby="152" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>10</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="153" aria-labelledby="153" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1bbaafb0b148&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fconv2d-to-finally-understand-what-happens-in-the-forward-pass-1bbaafb0b148&amp;source=---author_recirc--e0a6ca3f9502----3-----------------bookmark_preview----b2d10c19_95e0_4e87_bbdc_cccecbe4df8c--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="wb bh xc dk dl ahr ahs aht"></div><div class="ac ut us ke kg ki"><a class="bf b bg ab bk tx wl wm wn nh ne wo ev ew ex wp wq wr fa ws wt wu wv ww fb fc fd bm fe ff" rel="noopener follow" href="/@axel-thevenot?source=post_page---author_recirc--e0a6ca3f9502---------------------------------------" data-discover="true"><div class="m ff">See all from Axel Thevenot üê£</div></a><div class="ahu ahv ahw ahx ahy ahz aia aib aic my m"><a class="bf b bg ab bk tx wl wm wn nh ne wo ev ew ex wp wq wr fa ws wt wu wv ww fb fc fd bm fe ff" href="https://medium.com/google-cloud?source=post_page---author_recirc--e0a6ca3f9502---------------------------------------" rel="noopener follow"><div class="m ff">See all from Google Cloud - Community</div></a></div></div></div></div><div class="wb bh xc aid aie aif aig aih"></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="aii aij m"><h2 class="bf gi qh jm gk qj jp gm ql qn qo qp qr qs qt qv qw bk">Recommended from Medium</h2><div class="oj ok ol om on m"><div class="abf ac me kv adr ads adt adu adv adw adx ady adz aea aeb aec aed aee aef"><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/@iamgabs/optimizing-google-bigquery-d81ff62dbfb1" tabindex="0"><div class="afr"><div aria-label="Optimizing Google BigQuery"><div class="aft afu afv afw acq"><img alt="Optimizing Google BigQuery" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*h0nH_GrCAGjmteldExrxvw.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="154" aria-labelledby="154" role="tooltip"><div tabindex="-1" class="be"><a tabindex="-1" rel="noopener follow" href="/@iamgabs?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div class="m fl"><img alt="Gabriel Carvalho" class="m fd bx agj agk cx" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*LKkeAEzsp1cK_f0DFBcB4A.jpeg"><div class="ft bx m agj agk fu o aj fv"></div></div></a></div></div></div></div></div><div><div class="m" aria-hidden="false" aria-describedby="155" aria-labelledby="155" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@iamgabs?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Gabriel Carvalho</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/@iamgabs/optimizing-google-bigquery-d81ff62dbfb1?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Optimizing Google BigQuery</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Strategies for Enhanced Performance and Cost Efficiency</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>Apr 11</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/@iamgabs/optimizing-google-bigquery-d81ff62dbfb1?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="206" aria-labelledby="206" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>11</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="156" aria-labelledby="156" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="157" aria-labelledby="157" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd81ff62dbfb1&amp;operation=register&amp;redirect=https%3A%2F%2Fiamgabs.medium.com%2Foptimizing-google-bigquery-d81ff62dbfb1&amp;source=---read_next_recirc--e0a6ca3f9502----0-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/code-like-a-girl/crack-your-bigquery-interview-7436c3d49888" tabindex="0"><div class="afr"><div aria-label="Crack Your BigQuery Interview"><div class="aft afu afv afw acq"><img alt="Crack Your BigQuery Interview" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*KDSa99_4i_1cIvpNqylV2g.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="158" aria-labelledby="158" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/code-like-a-girl?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><div class="fl"><img alt="Code Like A Girl" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*rt1mE2Q0rmKsUcJX2ewFoA.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="159" aria-labelledby="159" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/code-like-a-girl?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Code Like A Girl</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="160" aria-labelledby="160" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@sakthismessage?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">sakthismessage</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/code-like-a-girl/crack-your-bigquery-interview-7436c3d49888?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Crack Your BigQuery Interview</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Everything you need to know about BigQuery concepts in data engineering interviews</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><div class="ug ac"><div class="bm" aria-hidden="false" aria-describedby="161" aria-labelledby="161"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="162" aria-labelledby="162" role="tooltip"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Jun 12</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/code-like-a-girl/crack-your-bigquery-interview-7436c3d49888?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="208" aria-labelledby="208" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>20</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="163" aria-labelledby="163" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7436c3d49888&amp;operation=register&amp;redirect=https%3A%2F%2Fcode.likeagirl.io%2Fcrack-your-bigquery-interview-7436c3d49888&amp;source=---read_next_recirc--e0a6ca3f9502----1-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="abf ac me kv adr ads adt adu adv adw adx ady adz aea aeb aec aed aee aef"><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/@rxmeez/untangling-first-value-and-last-value-in-bigquery-sql-494cce988f20" tabindex="0"><div class="afr"><div aria-label="Untangling FIRST_VALUE and LAST_VALUE in BigQuery SQL"><div class="aft afu afv afw acq"><img alt="Untangling FIRST_VALUE and LAST_VALUE in BigQuery SQL" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/0*vSU3Ffv-xABmb4yy"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="164" aria-labelledby="164" role="tooltip"><div tabindex="-1" class="be"><a tabindex="-1" rel="noopener follow" href="/@rxmeez?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div class="m fl"><img alt="Rameez Khan" class="m fd bx agj agk cx" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*o5m7xkDU9xIoQqknvX2jLA.jpeg"><div class="ft bx m agj agk fu o aj fv"></div></div></a></div></div></div></div></div><div><div class="m" aria-hidden="false" aria-describedby="165" aria-labelledby="165" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@rxmeez?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Rameez Khan</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/@rxmeez/untangling-first-value-and-last-value-in-bigquery-sql-494cce988f20?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Untangling FIRST_VALUE and LAST_VALUE in BigQuery SQL</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Ever found yourself wrestling with window functions, trying to grab the ‚Äúfirst‚Äù and ‚Äúlast‚Äù something within a group of rows? You have‚Ä¶</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><div class="ug ac"><div class="bm" aria-hidden="false" aria-describedby="166" aria-labelledby="166"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="167" aria-labelledby="167" role="tooltip"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Apr 28</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/@rxmeez/untangling-first-value-and-last-value-in-bigquery-sql-494cce988f20?source=post_page---read_next_recirc--e0a6ca3f9502----0---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="209" aria-labelledby="209" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>50</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="168" aria-labelledby="168" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F494cce988f20&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40rxmeez%2Funtangling-first-value-and-last-value-in-bigquery-sql-494cce988f20&amp;source=---read_next_recirc--e0a6ca3f9502----0-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/pipeline-perspectives/dataform-ci-cd-sucks-7e19f4c8f816" tabindex="0"><div class="afr"><div aria-label="How We Have Solved Reliable CI/CD for Dataform"><div class="aft afu afv afw acq"><img alt="How We Have Solved Reliable CI/CD for Dataform" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*ws43FqqfR4ag6w_hpOUa4w.png"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="169" aria-labelledby="169" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/pipeline-perspectives?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><div class="fl"><img alt="Pipeline Perspectives" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*B_2liJBoST9wf0wJwFvycA.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="170" aria-labelledby="170" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/pipeline-perspectives?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Pipeline Perspectives</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="171" aria-labelledby="171" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@mkamysz?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Mike Kamysz</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/pipeline-perspectives/dataform-ci-cd-sucks-7e19f4c8f816?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">How We Have Solved Reliable CI/CD for Dataform</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">300+ models. Hundreds of terabytes. Reliable deployment processes are crucial. Here‚Äôs how we made it work for us.</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><div class="ug ac"><div class="bm" aria-hidden="false" aria-describedby="172" aria-labelledby="172"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="173" aria-labelledby="173" role="tooltip"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Aug 8</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/pipeline-perspectives/dataform-ci-cd-sucks-7e19f4c8f816?source=post_page---read_next_recirc--e0a6ca3f9502----1---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="210" aria-labelledby="210" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>8</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="174" aria-labelledby="174" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e19f4c8f816&amp;operation=register&amp;redirect=https%3A%2F%2Fperspectives.datainstitute.io%2Fdataform-ci-cd-sucks-7e19f4c8f816&amp;source=---read_next_recirc--e0a6ca3f9502----1-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/dev-genius/advanced-apache-airflow-patterns-retry-failover-sla-monitoring-and-sensor-tasks-772bd22b72ba" tabindex="0"><div class="afr"><div aria-label="Advanced Apache Airflow Patterns: Retry &amp; Failover, SLA Monitoring, and Sensor Tasks"><div class="aft afu afv afw acq"><img alt="Advanced Apache Airflow Patterns: Retry &amp; Failover, SLA Monitoring, and Sensor Tasks" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/1*dVo2weq72srhAwREhggmFg@2x.jpeg"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="175" aria-labelledby="175" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/dev-genius?source=post_page---read_next_recirc--e0a6ca3f9502----2---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><div class="fl"><img alt="Dev Genius" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*CvejhRq3NYsivxILYXEdfA.jpeg"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="176" aria-labelledby="176" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/dev-genius?source=post_page---read_next_recirc--e0a6ca3f9502----2---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Dev Genius</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="177" aria-labelledby="177" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@saurabhd29?source=post_page---read_next_recirc--e0a6ca3f9502----2---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Saurabh Doiphode</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/dev-genius/advanced-apache-airflow-patterns-retry-failover-sla-monitoring-and-sensor-tasks-772bd22b72ba?source=post_page---read_next_recirc--e0a6ca3f9502----2---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title="Advanced Apache Airflow Patterns: Retry &amp; Failover, SLA Monitoring, and Sensor Tasks"><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Advanced Apache Airflow Patterns: Retry &amp; Failover, SLA Monitoring, and Sensor Tasks</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Note: Non-members can read the full article here</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><div class="ug ac"><div class="bm" aria-hidden="false" aria-describedby="178" aria-labelledby="178"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="179" aria-labelledby="179" role="tooltip"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Mar 4</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/dev-genius/advanced-apache-airflow-patterns-retry-failover-sla-monitoring-and-sensor-tasks-772bd22b72ba?source=post_page---read_next_recirc--e0a6ca3f9502----2---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="211" aria-labelledby="211" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>80</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="180" aria-labelledby="180" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F772bd22b72ba&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.devgenius.io%2Fadvanced-apache-airflow-patterns-retry-failover-sla-monitoring-and-sensor-tasks-772bd22b72ba&amp;source=---read_next_recirc--e0a6ca3f9502----2-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="wb bh xc nb"></div></div></div></div></div></div></div></div></article></div></div><div class="aeg aeh aei vn aej aek ael vm aem aen aeo aep aeq aer aes aet aeu aev aew aex aey"><div class="aez afa afb afc afd dw m"><article class="dw" data-testid="post-preview"><div class="dw ug m"><div class="bh dw"><div class="dw m"><div class="fl dw afe aff afg afh afi afj afk afl afm afn afo afp afq" role="link" data-href="https://medium.com/google-cloud/understanding-bigquery-pricing-a-comprehensive-guide-b775ed25399f" tabindex="0"><div class="afr"><div aria-label="Understanding BigQuery Pricing: A Comprehensive Guide"><div class="aft afu afv afw acq"><img alt="Understanding BigQuery Pricing: A Comprehensive Guide" class="bh afx afy afz bw" loading="lazy" src="https://miro.medium.com/v2/resize:fit:849/5f1f586cc41943becdefc4cf716f5e4d75f28bf980a0168ac5279df3fcf6dd00"></div></div></div><div class="afs ac cb co"><div class="ac co yg bh aga agb agc agd"><div class="age agf agg agh agi ac r"><div class="tw m"><div><div class="m" aria-hidden="false" aria-describedby="181" aria-labelledby="181" role="tooltip"><div tabindex="-1" class="be"><a href="https://medium.com/google-cloud?source=post_page---read_next_recirc--e0a6ca3f9502----3---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><div class="fl"><img alt="Google Cloud - Community" class="cx hi m agk agj" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:25:25/1*FUjLiCANvATKeaJEeg20Rw.png"><div class="hi m agj agk fu o ft fv"></div></div></a></div></div></div></div><div class="vo m fz"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="182" aria-labelledby="182" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" href="https://medium.com/google-cloud?source=post_page---read_next_recirc--e0a6ca3f9502----3---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" rel="noopener follow"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Google Cloud - Community</p></a></div></div></div></div><div class="agl m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="183" aria-labelledby="183" role="tooltip"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kt ac r" rel="noopener follow" href="/@vishalbulbule?source=post_page---read_next_recirc--e0a6ca3f9502----3---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><p class="bf b dv ab fx adi fy ti adj tk adk tl bk">Vishal Bulbule</p></a></div></div></div></div><div class="agm m agn ago agp agq agr hn"><div class="ags agt agu agv agw agx agy agz"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/google-cloud/understanding-bigquery-pricing-a-comprehensive-guide-b775ed25399f?source=post_page---read_next_recirc--e0a6ca3f9502----3---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div title=""><h2 class="bf in qh jm aha ahb gk qj jp ahc ahd gm gn go ahe ahf gp gq gr ahg ahh gs gt gu ahi ahj gv fx fy ti tk tl bk">Understanding BigQuery Pricing: A Comprehensive Guide</h2></div><div class="ahk m"><h3 class="bf b gy ab fx th fy ti tj tk tl du">Google BigQuery is a fully managed, serverless data warehouse that enables scalable analysis over petabytes of data. Its pricing model is‚Ä¶</h3></div></a></div></div><span class="bf b dv ab du"><div class="ve ac cp af"><div class="ac r ahn"><span>Apr 22</span><div class=""><div class="fl ahl dh ac r"><div class="fu hf ahm ac r ahn"><div class="fg dh dj m cx"></div></div><a class="fu nc ahm ac r ahn" tabindex="-1" rel="noopener follow" href="/google-cloud/understanding-bigquery-pricing-a-comprehensive-guide-b775ed25399f?source=post_page---read_next_recirc--e0a6ca3f9502----3---------------------b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="212" aria-labelledby="212" role="tooltip"><div tabindex="-1" class="be"><div class="ac r adg"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r aho ahp"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="184" aria-labelledby="184" role="tooltip"><div tabindex="-1" class="be"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb775ed25399f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Funderstanding-bigquery-pricing-a-comprehensive-guide-b775ed25399f&amp;source=---read_next_recirc--e0a6ca3f9502----3-----------------bookmark_preview----b5e25083_b5f4_43d8_8016_188d20d8f97f--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nh ahq" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="wb bh xc dk dl ahr ahs aht"></div><a class="bf b bg ab bk tx wl wm wn nh ne wo ev ew ex wp wq wr fa ws wt wu wv ww fb fc fd bm fe ff" rel="noopener follow" href="/?source=post_page---read_next_recirc--e0a6ca3f9502---------------------------------------" data-discover="true"><div class="m ff">See more recommendations</div></a></div></div></div><div class="i l k"><div class="wb bh xc xd"></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="xe ac me kv"><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Help</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Status</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><p class="bf b dv ab du">About</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e0a6ca3f9502---------------------------------------" data-discover="true"><p class="bf b dv ab du">Careers</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b dv ab du">Press</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Blog</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Privacy</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Rules</p></a></div><div class="xf xg m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Terms</p></a></div><div class="xf m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----e0a6ca3f9502---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250815-181149-c5f8bb8700"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-e0a6ca3f9502","user-a8fcc1458e87","collection-e52cf94d98af"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"shouldFollowPostQueryEnabled":false,"newLoNonMocUpsellExperimentGroup":"control"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"91b58852-cd4a-4657-9e74-6de3bd17f0f3","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-e10608bc5f21939405fa46f0f1ba1a13-9616c221f71308c1-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"staticRouterContext":{"route":{"name":"ShowPostUnderCollection"},"statusCode":200},"toastQueue":[],"currentToast":null,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250815-181149-c5f8bb8700","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","iosAppId":"828256236","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250815-181149-c5f8bb8700","commit":"c5f8bb8700feb9e3ad13518b3080a6843d58d294"}},"datacenter":"us"},"googleAdsCode":"AW-17106321204","googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"167cff2a3d17ac1e64d0762539978f2d54c0058886e8b3c8a03a725a83012ec0","height":630,"width":1200},"postPreviewImage":{"imageId":"bc1f8416df0cad099e43cda2872716e5864f18a73bda2a7547ea082aca9b5632","height":630,"width":1200}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don‚Äôt fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"google-cloud\"})":{"__ref":"Collection:e52cf94d98af"},"postResult({\"id\":\"e0a6ca3f9502\"})":{"__ref":"Post:e0a6ca3f9502"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:e52cf94d98af":{"__typename":"Collection","id":"e52cf94d98af","favicon":{"__ref":"ImageMetadata:"},"domain":null,"slug":"google-cloud","googleAnalyticsId":null,"name":"Google Cloud - Community","avatar":{"__ref":"ImageMetadata:1*FUjLiCANvATKeaJEeg20Rw.png"},"description":"A collection of technical articles and blogs published or curated by Google Cloud Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.","subscriberCount":67259,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:bf454441e886"}]},"compatV3":{"__ref":"Publication:e52cf94d98af"},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:e52cf94d98af-viewerId:lo_e8d228b282f0"},"twitterUsername":"googlecloudtech","facebookPageId":null},"ImageMetadata:1*FUjLiCANvATKeaJEeg20Rw.png":{"__typename":"ImageMetadata","id":"1*FUjLiCANvATKeaJEeg20Rw.png"},"User:97db6ebb7610":{"__typename":"User","id":"97db6ebb7610","customDomainState":null,"hasSubdomain":false,"username":"anfeldman"},"Post:bf454441e886":{"__typename":"Post","id":"bf454441e886","firstPublishedAt":1755277613173,"creator":{"__ref":"User:97db6ebb7610"},"collection":{"__ref":"Collection:e52cf94d98af"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fthe-silent-killer-of-developer-flow-how-ai-just-brought-your-database-home-bf454441e886","sequence":null,"uniqueSlug":"the-silent-killer-of-developer-flow-how-ai-just-brought-your-database-home-bf454441e886"},"Publication:e52cf94d98af":{"__typename":"Publication","id":"e52cf94d98af","theme":{"__typename":"PublicationTheme","accentColor":{"__typename":"ColorValue","rgb":""}}},"LinkedAccounts:a8fcc1458e87":{"__typename":"LinkedAccounts","mastodon":null,"id":"a8fcc1458e87"},"NewsletterV3:bb1ccd160e04":{"__typename":"NewsletterV3","id":"bb1ccd160e04","type":"NEWSLETTER_TYPE_AUTHOR","slug":"a8fcc1458e87","name":"a8fcc1458e87","collection":null,"user":{"__ref":"User:a8fcc1458e87"}},"User:a8fcc1458e87":{"__typename":"User","id":"a8fcc1458e87","name":"Axel Thevenot üê£","username":"axel-thevenot","newsletterV3":{"__ref":"NewsletterV3:bb1ccd160e04"},"linkedAccounts":{"__ref":"LinkedAccounts:a8fcc1458e87"},"isSuspended":false,"imageId":"1*hOsGwzYlwIq_FnMC-mBk8Q.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"axel-thevenot.medium.com"}},"hasSubdomain":true,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":1428,"followingCount":61,"collectionFollowingCount":8},"bio":"Lead Data Engineer | www.linkedin.com\u002Fin\u002Faxel-thevenot | axel.thevenot.pro@gmail.com","membership":{"__ref":"Membership:879da0ea-8ab8-483d-86c1-ad66f0d74117"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:a8fcc1458e87-viewerId:lo_e8d228b282f0"},"twitterScreenName":""},"Membership:879da0ea-8ab8-483d-86c1-ad66f0d74117":{"__typename":"Membership","tier":"MEMBER","id":"879da0ea-8ab8-483d-86c1-ad66f0d74117"},"Topic:decb52b64abf":{"__typename":"Topic","slug":"programming","id":"decb52b64abf","name":"Programming"},"Paragraph:5acb773e025c_0":{"__typename":"Paragraph","id":"5acb773e025c_0","name":"e724","type":"H3","href":null,"layout":null,"metadata":null,"text":"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_1":{"__typename":"Paragraph","id":"5acb773e025c_1","name":"a4f6","type":"H4","href":null,"layout":null,"metadata":null,"text":"A complete guide for maximizing the potential of BigQuery window functions to manipulate and transform data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YFnqJT_pzovNPxnBtLuEQg.png":{"__typename":"ImageMetadata","id":"1*YFnqJT_pzovNPxnBtLuEQg.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_2":{"__typename":"Paragraph","id":"5acb773e025c_2","name":"0685","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YFnqJT_pzovNPxnBtLuEQg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_3":{"__typename":"Paragraph","id":"5acb773e025c_3","name":"30cd","type":"P","href":null,"layout":null,"metadata":null,"text":"BigQuery is a fully managed data warehouse that uses Google‚Äôs infrastructure that allows fast processing of SQL queries. It is especially useful for analyzing, exploring, and visualizing large amounts of data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":149,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":160,"end":169,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":175,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_4":{"__typename":"Paragraph","id":"5acb773e025c_4","name":"9295","type":"P","href":null,"layout":null,"metadata":null,"text":"This article simplifies and helps to visualize the concepts of windows in Google Cloud for non-developers, as they can be challenging to understand despite the very comprehensive documentation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":179,"end":192,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fwindow-function-calls","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":13,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":160,"end":178,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_5":{"__typename":"Paragraph","id":"5acb773e025c_5","name":"7e62","type":"P","href":null,"layout":null,"metadata":null,"text":"In this guide, we will examine the windows functions (also named analytic functions) in BigQuery and learn how to effectively utilize them for data analysis and manipulation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":65,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":143,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_6":{"__typename":"Paragraph","id":"5acb773e025c_6","name":"1339","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Summary\nIntroduction\nBasic syntax and usage of windows functions\nKey components of a window declaration\nCommon windows functions in BigQuery\nAdvanced window declaration: the window frame clause\nNamed windows\nThe QUALIFY clause\nTips and best practices for using windows functions in BigQuery\nConclusion","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_7":{"__typename":"Paragraph","id":"5acb773e025c_7","name":"18d8","type":"P","href":null,"layout":null,"metadata":null,"text":"[Looking for more BigQuery insights? Check out Built with BigQuery: Lytics launches secure data sharing and enrichment solution on Google Cloud.]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":47,"end":143,"href":"http:\u002F\u002Fbit.ly\u002FLyticsBQ","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_8":{"__typename":"Paragraph","id":"5acb773e025c_8","name":"1e9e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Basic syntax and usage of windows functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_9":{"__typename":"Paragraph","id":"5acb773e025c_9","name":"431d","type":"P","href":null,"layout":null,"metadata":null,"text":"Window or analytic functions in BigQuery enable advanced data manipulation and transformation. They allow you to perform calculations over a set of rows related to the current row.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":48,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":134,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_10":{"__typename":"Paragraph","id":"5acb773e025c_10","name":"45d1","type":"P","href":null,"layout":null,"metadata":null,"text":"With a window function, it is possible to perform calculations on rows within a result set, such as averaging or ranking, while keeping the individual values of those rows.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":71,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":100,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":113,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_11":{"__typename":"Paragraph","id":"5acb773e025c_11","name":"e980","type":"PQ","href":null,"layout":null,"metadata":null,"text":"You can work with values and aggregated values at the same time because the rows are not combined or merged.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_12":{"__typename":"Paragraph","id":"5acb773e025c_12","name":"4a9f","type":"P","href":null,"layout":null,"metadata":null,"text":"To use a window function in a query, you need to specify the function you want to use, followed by the OVER() clause, which determines the rows to apply the function to.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":103,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":87,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_13":{"__typename":"Paragraph","id":"5acb773e025c_13","name":"6302","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: the details of the OVER() clause will be covered in the next part.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_14":{"__typename":"Paragraph","id":"5acb773e025c_14","name":"4a00","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT \n  customer_id, \n  sales_amount,\n  SUM(sales_amount) OVER(PARTITION BY customer_id) AS total_sales_per_customer\nFROM sales","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_15":{"__typename":"Paragraph","id":"5acb773e025c_15","name":"7517","type":"P","href":null,"layout":null,"metadata":null,"text":"It may appear similar to a query with a GROUP BY like below, but the difference is significant.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_16":{"__typename":"Paragraph","id":"5acb773e025c_16","name":"bd77","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT \n  customer_id, \n  SUM(sales_amount) AS total_sales_per_customer\nFROM sales\nGROUP BY \n  customer_id","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_17":{"__typename":"Paragraph","id":"5acb773e025c_17","name":"e314","type":"P","href":null,"layout":null,"metadata":null,"text":"So what is the difference between using GROUP BY and windows?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_18":{"__typename":"Paragraph","id":"5acb773e025c_18","name":"b8ce","type":"P","href":null,"layout":null,"metadata":null,"text":"For a simple aggregation function, the main difference between using GROUP BY and windows is the scope of the function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":69,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":97,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TwUVYBt8RQ-Bs9Ih_42y_A.png":{"__typename":"ImageMetadata","id":"1*TwUVYBt8RQ-Bs9Ih_42y_A.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_19":{"__typename":"Paragraph","id":"5acb773e025c_19","name":"9327","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TwUVYBt8RQ-Bs9Ih_42y_A.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_20":{"__typename":"Paragraph","id":"5acb773e025c_20","name":"8f19","type":"P","href":null,"layout":null,"metadata":null,"text":"While GROUP BY is used to group rows and apply a function to each group, a window is used to apply a function to each individual row.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":6,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":58,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":110,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_21":{"__typename":"Paragraph","id":"5acb773e025c_21","name":"30c6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Key components of a window declaration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_22":{"__typename":"Paragraph","id":"5acb773e025c_22","name":"051b","type":"P","href":null,"layout":null,"metadata":null,"text":"This section introduces how to define your window. In other words, how to declare your OVER() clause. Advanced window declarations will be covered in a later section. Right now, we will focus on the two main components of the OVER() clause: PARTITION BY and ORDER BY.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":87,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":226,"end":232,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":241,"end":253,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":258,"end":266,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":31,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_23":{"__typename":"Paragraph","id":"5acb773e025c_23","name":"cd8d","type":"H4","href":null,"layout":null,"metadata":null,"text":"PARTITION BY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_24":{"__typename":"Paragraph","id":"5acb773e025c_24","name":"4c09","type":"P","href":null,"layout":null,"metadata":null,"text":"The PARTITION BY expression is easy to understand. It simply breaks up the rows into separate chunks (partitions). The window function is then independently evaluated over each of these partitions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":61,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":80,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":102,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_25":{"__typename":"Paragraph","id":"5acb773e025c_25","name":"2650","type":"P","href":null,"layout":null,"metadata":null,"text":"You can even use multiple expressions to partition on multiple fields at once. Let‚Äôs see an example to clarify things.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_26":{"__typename":"Paragraph","id":"5acb773e025c_26","name":"ac8f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  score,\n  grade,\n  AVG(score) OVER(PARTITION BY name)        AS average_score,\n  COUNT(*)   OVER(PARTITION BY name, grade) AS number_same_grade\nFROM students","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wX_kNoHvXM7F5IMVG8R8OQ.png":{"__typename":"ImageMetadata","id":"1*wX_kNoHvXM7F5IMVG8R8OQ.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_27":{"__typename":"Paragraph","id":"5acb773e025c_27","name":"c2a0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wX_kNoHvXM7F5IMVG8R8OQ.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_28":{"__typename":"Paragraph","id":"5acb773e025c_28","name":"2ff5","type":"P","href":null,"layout":null,"metadata":null,"text":"In this example, we can find the average score for each student by creating a unique partition for each student. Similarly, we can create partitions for each student and letter grade to count them globally.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":78,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_29":{"__typename":"Paragraph","id":"5acb773e025c_29","name":"15d3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: If PARTITION BY is not specified, all the rows will be considered.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_30":{"__typename":"Paragraph","id":"5acb773e025c_30","name":"2d44","type":"H4","href":null,"layout":null,"metadata":null,"text":"ORDER BY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_31":{"__typename":"Paragraph","id":"5acb773e025c_31","name":"bbcb","type":"P","href":null,"layout":null,"metadata":null,"text":"The ORDER BY clause determines the arrangement of the rows within each partition. If no ORDER BY clause is specified, the order of the rows within each partition is undefined.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":88,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":35,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":59,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":165,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_32":{"__typename":"Paragraph","id":"5acb773e025c_32","name":"ef4f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: You can also use multiple expressions here. If the first expression is equal between two rows, it will compare the second one, and so on.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_33":{"__typename":"Paragraph","id":"5acb773e025c_33","name":"4e83","type":"P","href":null,"layout":null,"metadata":null,"text":"The major benefit of the ORDER BY clause is that it creates a sliding window from the first to the current row (by default).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":62,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_34":{"__typename":"Paragraph","id":"5acb773e025c_34","name":"1177","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is an example of a cumulative sum using this clause.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_35":{"__typename":"Paragraph","id":"5acb773e025c_35","name":"1be5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  product_name, \n  sales_date,\n  sales_amount,\n  SUM(sales_amount) OVER(ORDER BY sales_date)                           AS cumulative_sales,\n  SUM(sales_amount) OVER(PARTITION BY product_name ORDER BY sales_date) AS cumulative_product_sales,\nFROM sales","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*F71EXQHoix9JtbYMJvGhfg.png":{"__typename":"ImageMetadata","id":"1*F71EXQHoix9JtbYMJvGhfg.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_36":{"__typename":"Paragraph","id":"5acb773e025c_36","name":"77b9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*F71EXQHoix9JtbYMJvGhfg.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_37":{"__typename":"Paragraph","id":"5acb773e025c_37","name":"58de","type":"P","href":null,"layout":null,"metadata":null,"text":"Do you notice anything strange in the cumulative_sale feature for 2022‚Äì12‚Äì23 and 2022‚Äì12‚Äì24?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":38,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_38":{"__typename":"Paragraph","id":"5acb773e025c_38","name":"f44d","type":"P","href":null,"layout":null,"metadata":null,"text":"I mentioned earlier that the ORDER BY statement creates a sliding window from the first to the current row. However, for aggregation functions, rows with equal values are included with the current row.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":29,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":144,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_39":{"__typename":"Paragraph","id":"5acb773e025c_39","name":"b8c0","type":"P","href":null,"layout":null,"metadata":null,"text":"So their order is undefined.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":18,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_40":{"__typename":"Paragraph","id":"5acb773e025c_40","name":"49d7","type":"P","href":null,"layout":null,"metadata":null,"text":"To fix this issue, you can simply add the product_name in the expressions. Easy peasy!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":42,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_41":{"__typename":"Paragraph","id":"5acb773e025c_41","name":"8064","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  product_name, \n  sales_date,\n  sales_amount,\n  SUM(sales_amount) OVER(ORDER BY sales_date, product_name)             AS cumulative_sales,\n  SUM(sales_amount) OVER(PARTITION BY product_name ORDER BY sales_date) AS cumulative_product_sales,\nFROM sales","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*52FEQLhyU6OtRjAE-0ZXhg.png":{"__typename":"ImageMetadata","id":"1*52FEQLhyU6OtRjAE-0ZXhg.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_42":{"__typename":"Paragraph","id":"5acb773e025c_42","name":"ced8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*52FEQLhyU6OtRjAE-0ZXhg.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_43":{"__typename":"Paragraph","id":"5acb773e025c_43","name":"481d","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: If ORDER BY is not specified, all the rows will be considered within the partition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":9,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_44":{"__typename":"Paragraph","id":"5acb773e025c_44","name":"e379","type":"H3","href":null,"layout":null,"metadata":null,"text":"Common windows functions in BigQuery","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_45":{"__typename":"Paragraph","id":"5acb773e025c_45","name":"bf2b","type":"P","href":null,"layout":null,"metadata":null,"text":"In this section, we will cover three types of functions that can be used within a partition: aggregation, numbering, and navigation functions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":93,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":106,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":121,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_46":{"__typename":"Paragraph","id":"5acb773e025c_46","name":"f162","type":"H4","href":null,"layout":null,"metadata":null,"text":"Aggregation functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_47":{"__typename":"Paragraph","id":"5acb773e025c_47","name":"9e94","type":"P","href":null,"layout":null,"metadata":null,"text":"Speaking of aggregation functions, I am sure you already are familiar with them as you probably use them regularly. These functions include AVG(), COUNT(), MAX(), MIN(), SUM().","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":140,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":147,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":156,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":163,"end":168,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":170,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":105,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_48":{"__typename":"Paragraph","id":"5acb773e025c_48","name":"3c81","type":"P","href":null,"layout":null,"metadata":null,"text":"To refresh your memory, we learned in the last sections that we can compute:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_49":{"__typename":"Paragraph","id":"5acb773e025c_49","name":"ccef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A global aggregation value within the partition if no ORDER BY is specified.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":54,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":2,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_50":{"__typename":"Paragraph","id":"5acb773e025c_50","name":"bc1e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If we specify the ORDER BY expression, we can compute a cumulative aggregation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":18,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":56,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_51":{"__typename":"Paragraph","id":"5acb773e025c_51","name":"9361","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  score,\n  exam_date,\n  AVG(score) OVER()                   AS global_average_score,\n  AVG(score) OVER(ORDER BY exam_date) AS running_average_score\nFROM students","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*W5RVJ5Id86830FmLcqHMHw.png":{"__typename":"ImageMetadata","id":"1*W5RVJ5Id86830FmLcqHMHw.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_52":{"__typename":"Paragraph","id":"5acb773e025c_52","name":"ae0b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*W5RVJ5Id86830FmLcqHMHw.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_53":{"__typename":"Paragraph","id":"5acb773e025c_53","name":"cd6e","type":"P","href":null,"layout":null,"metadata":null,"text":"For more functions, check out the aggregation functions documentation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":34,"end":69,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Faggregate_functions","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_54":{"__typename":"Paragraph","id":"5acb773e025c_54","name":"bdde","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Statistical aggregation functions are also supported. Approximate aggregation functions are not supported.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":39,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fstatistical_aggregate_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":60,"end":93,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fapproximate_aggregate_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":40,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_55":{"__typename":"Paragraph","id":"5acb773e025c_55","name":"df56","type":"H4","href":null,"layout":null,"metadata":null,"text":"Numbering functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_56":{"__typename":"Paragraph","id":"5acb773e025c_56","name":"d340","type":"P","href":null,"layout":null,"metadata":null,"text":"Numbering functions, as the name suggests, generate a sequence of numbers. They assign numeric values to each row based on its position within the specified window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":43,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":114,"end":163,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_57":{"__typename":"Paragraph","id":"5acb773e025c_57","name":"2dca","type":"P","href":null,"layout":null,"metadata":null,"text":"The three main numbering functions are:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_58":{"__typename":"Paragraph","id":"5acb773e025c_58","name":"76ce","type":"ULI","href":null,"layout":null,"metadata":null,"text":"RANK(): returns the rank of each row within the ordered partition. All rows with the same value receive the same rank.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":20,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":37,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_59":{"__typename":"Paragraph","id":"5acb773e025c_59","name":"bea2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"DENSE_RANK(): same as the RANK() function, but it does not leave gaps between integers for subsequent rows with the same value.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":26,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":50,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_60":{"__typename":"Paragraph","id":"5acb773e025c_60","name":"1405","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ROW_NUMBER(): assigns a distinct sequential integer to each row. Unlike the other functions, it does not require an ORDER BY expression.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":116,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":24,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":96,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_61":{"__typename":"Paragraph","id":"5acb773e025c_61","name":"8a09","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  score,\n  ROW_NUMBER()   OVER(ORDER BY score DESC) AS student_row_number,\n  RANK()         OVER(ORDER BY score DESC) AS student_rank,\n  DENSE_RANK()   OVER(ORDER BY score DESC) AS student_dense_rank,\n  PERCENT_RANK() OVER(ORDER BY score DESC) AS student_percent_rank,\n  CUME_DIST()    OVER(ORDER BY score DESC) AS student_cumulative_distribution,\n  NTILE(2)       OVER(ORDER BY score DESC) AS student_two_tiles\nFROM students","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*e0OWNd0y0s3__zxni9sQkg.png":{"__typename":"ImageMetadata","id":"1*e0OWNd0y0s3__zxni9sQkg.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_62":{"__typename":"Paragraph","id":"5acb773e025c_62","name":"c0da","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*e0OWNd0y0s3__zxni9sQkg.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_63":{"__typename":"Paragraph","id":"5acb773e025c_63","name":"2575","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: this example demonstrates the six numbering functions that are currently available. Check out the documentation for more detail.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":104,"end":117,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fnumbering_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":69,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_64":{"__typename":"Paragraph","id":"5acb773e025c_64","name":"7621","type":"H4","href":null,"layout":null,"metadata":null,"text":"Navigation functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_65":{"__typename":"Paragraph","id":"5acb773e025c_65","name":"38c0","type":"P","href":null,"layout":null,"metadata":null,"text":"Navigation functions are used to navigate through a partition to access a specific value from a previous or subsequent row within its partition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":65,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_66":{"__typename":"Paragraph","id":"5acb773e025c_66","name":"704e","type":"P","href":null,"layout":null,"metadata":null,"text":"Let‚Äôs have an example of what can be achieved with navigation functions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_67":{"__typename":"Paragraph","id":"5acb773e025c_67","name":"3647","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary,\n  fiscal_year,\n  LAG(salary)          OVER(PARTITION BY name ORDER BY fiscal_year) AS previous_salary,\n  LEAD(salary, 2, 0)   OVER(PARTITION BY name ORDER BY fiscal_year) AS two_salary_after,\n  FIRST_VALUE(salary)  OVER(PARTITION BY name ORDER BY fiscal_year) AS first_salary,\n  NTH_VALUE(salary, 3) OVER(PARTITION BY name ORDER BY fiscal_year) AS third_salary, \n  LAST_VALUE(salary)   OVER(PARTITION BY name ORDER BY fiscal_year) AS last_salary\nFROM employees","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ga6uBMtFA2fsw_Sm14qIlA.png":{"__typename":"ImageMetadata","id":"1*ga6uBMtFA2fsw_Sm14qIlA.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_68":{"__typename":"Paragraph","id":"5acb773e025c_68","name":"affc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ga6uBMtFA2fsw_Sm14qIlA.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_69":{"__typename":"Paragraph","id":"5acb773e025c_69","name":"0863","type":"P","href":null,"layout":null,"metadata":null,"text":"In this example you can denote two types of navigation functions:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_70":{"__typename":"Paragraph","id":"5acb773e025c_70","name":"fa12","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The LAG() and LEAD() functions allow to respectively access to the preceding and following row value in an ordered window frame. \nIt is possible to skip more than one row by specifying an integer as a second argument. Additionally, a default value can be provided as a third argument in case the desired row does not exist, rather than returning NULL.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":14,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":346,"end":350,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":67,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":81,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":148,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":201,"end":216,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":234,"end":247,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":269,"end":283,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_71":{"__typename":"Paragraph","id":"5acb773e025c_71","name":"33b8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The FIRST_VALUE(), LAST_VALUE(), and NTH_VALUE() are pretty straightforward to understand. They respectively returns the first, last, and specified row value in an ordered window frame. \nIt is also possible to ignore null values in these functions by using the IGNORE NULLS expression. example: FIRST_VALUE(column IGNORE NULLS)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":19,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":37,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":261,"end":273,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":295,"end":327,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":121,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":128,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":138,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":210,"end":228,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":286,"end":327,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_72":{"__typename":"Paragraph","id":"5acb773e025c_72","name":"641d","type":"P","href":null,"layout":null,"metadata":null,"text":"As a reminder, as soon as you declare your ORDER BY expression, it creates a sliding window (called a ‚Äúwindow frame‚Äù) in the partition. This window frame starts at the first row of the partition and extends to the current row by default.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":43,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":103,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":154,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":199,"end":225,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":226,"end":236,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_73":{"__typename":"Paragraph","id":"5acb773e025c_73","name":"1481","type":"P","href":null,"layout":null,"metadata":null,"text":"So our LAST_VALUE() function returns the current row value, which is not particularly useful in our case‚Ä¶","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":7,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_74":{"__typename":"Paragraph","id":"5acb773e025c_74","name":"4522","type":"P","href":null,"layout":null,"metadata":null,"text":"Of course, you can change this default behavior. This drives us to our next part.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":11,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_75":{"__typename":"Paragraph","id":"5acb773e025c_75","name":"631c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: you can also compute the continuous or discrete percentile with the PERCENTILE_CONT() and PERCENTILE_DISCT() functions. \nCheck out the navigation functions documentation for more detail.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":74,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":96,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":141,"end":175,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fnavigation_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":31,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_76":{"__typename":"Paragraph","id":"5acb773e025c_76","name":"ef86","type":"H3","href":null,"layout":null,"metadata":null,"text":"Advanced window declaration: the window frame clause","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_77":{"__typename":"Paragraph","id":"5acb773e025c_77","name":"a6fc","type":"P","href":null,"layout":null,"metadata":null,"text":"The next step involves customizing the window frame using a window frame specification. This can help create a rolling average or grouping similar items together. \nAs an example, we can combine these two techniques.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":23,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":60,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":111,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":130,"end":146,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_78":{"__typename":"Paragraph","id":"5acb773e025c_78","name":"009e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  income,\n  amount,\n  fiscal_year,\n  SUM(amount) OVER(\n    ORDER BY fiscal_year \n    ROWS  BETWEEN 1 PRECEDING AND CURRENT ROW) AS sum_two_last_income,\n  SUM(amount) OVER(\n    ORDER BY fiscal_year \n    RANGE BETWEEN 1 PRECEDING AND CURRENT ROW) AS sum_two_last_year_income,\n  SUM(amount) OVER(\n    ORDER BY fiscal_year \n    RANGE BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING) AS sum_subsequent_income\nFROM incomes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZCmzuqOwpcHHBJ8yZ8tEHw.png":{"__typename":"ImageMetadata","id":"1*ZCmzuqOwpcHHBJ8yZ8tEHw.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_79":{"__typename":"Paragraph","id":"5acb773e025c_79","name":"89dd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZCmzuqOwpcHHBJ8yZ8tEHw.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_80":{"__typename":"Paragraph","id":"5acb773e025c_80","name":"d736","type":"P","href":null,"layout":null,"metadata":null,"text":"In the first column, sum_two_last_income, we are using a rolling sum to add up the current row and the row immediately preceding it. \nYou can include more preceding rows by changing the value of 1.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":195,"end":196,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":79,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":98,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_81":{"__typename":"Paragraph","id":"5acb773e025c_81","name":"e56e","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: CURRENT ROW is also equivalent to 0 PRECEDING or 0 FOLLOWING.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":6,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":40,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":55,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_82":{"__typename":"Paragraph","id":"5acb773e025c_82","name":"aeda","type":"P","href":null,"layout":null,"metadata":null,"text":"In the second column, sum_two_last_year_income, we are performing a rolling sum over the past two years rather than the past two rows.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":22,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":80,"end":133,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_83":{"__typename":"Paragraph","id":"5acb773e025c_83","name":"bc68","type":"P","href":null,"layout":null,"metadata":null,"text":"To specify this window frame, you can use:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_84":{"__typename":"Paragraph","id":"5acb773e025c_84","name":"4745","type":"ULI","href":null,"layout":null,"metadata":null,"text":"the ROWS expression to get the physical rows around the current row.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":31,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_85":{"__typename":"Paragraph","id":"5acb773e025c_85","name":"4be4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"the RANGE expression to get a logical range of rows around the current row. There must be exactly one expression in the ORDER BY clause, and the expression must have a numeric type.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":120,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":30,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_86":{"__typename":"Paragraph","id":"5acb773e025c_86","name":"aa86","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: you can use theUNIX_DATE() to range with your date. Same for UNIX_SECONDS(), UNIW_MILLIS(), or UNIX_MICROS() functions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":67,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":83,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":101,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":21,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":67,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":83,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_87":{"__typename":"Paragraph","id":"5acb773e025c_87","name":"15ed","type":"P","href":null,"layout":null,"metadata":null,"text":"The final example, sum_subsequent_income, demonstrates how you can create a window that starts after the current row and excludes the current row. The same is possible for preceding rows as well.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":19,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":117,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_88":{"__typename":"Paragraph","id":"5acb773e025c_88","name":"4be6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Default behavior window frame","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_89":{"__typename":"Paragraph","id":"5acb773e025c_89","name":"ac2c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If the ORDER BY expression is not specified, the default window frame specification is ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":7,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":87,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_90":{"__typename":"Paragraph","id":"5acb773e025c_90","name":"83be","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If the ORDER BY clause is specified and you use an aggregation function, the default window frame specification is RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":7,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":115,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_91":{"__typename":"Paragraph","id":"5acb773e025c_91","name":"0329","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: it is not possible to use a window frame specification with numbering functions, and it is only supported for the navigation functions FIRST_VALUE(), NTH_VALUE(), and LAST_VALUE().","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":141,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":156,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":173,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":66,"end":85,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fnumbering_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":120,"end":140,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fnavigation_functions","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":141,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":156,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":173,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_92":{"__typename":"Paragraph","id":"5acb773e025c_92","name":"2cdf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Sub-Note: For other functions, the ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW can be considered instead, even if you can not modify it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":35,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_93":{"__typename":"Paragraph","id":"5acb773e025c_93","name":"f1e1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Check out the window frame specification documentation for more detail.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":14,"end":54,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fwindow-function-calls#def_window_frame","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_94":{"__typename":"Paragraph","id":"5acb773e025c_94","name":"c4a9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Named WINDOWs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_95":{"__typename":"Paragraph","id":"5acb773e025c_95","name":"24cc","type":"P","href":null,"layout":null,"metadata":null,"text":"In BigQuery, a window can be either named or unnamed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":36,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":45,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_96":{"__typename":"Paragraph","id":"5acb773e025c_96","name":"89e2","type":"P","href":null,"layout":null,"metadata":null,"text":"An unnamed window is defined in the OVER() clause and is only used for the preceding aggregation, numbering, or navigation function. For example:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":36,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":21,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":29,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_97":{"__typename":"Paragraph","id":"5acb773e025c_97","name":"de1d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary,\n  fiscal_year,\n  LAG(salary)         OVER(PARTITION BY name ORDER BY fiscal_year) AS previous_salary,\n  FIRST_VALUE(salary) OVER(PARTITION BY name ORDER BY fiscal_year) AS first_salary,\n  SUM(salary)         OVER(PARTITION BY name ORDER BY fiscal_year) AS cumulative_sum_salary,\n  AVG(salary)         OVER(PARTITION BY name ORDER BY fiscal_year) AS cumulative_average_salary,\n  SUM(salary)         OVER(PARTITION BY name ORDER BY fiscal_year RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS three_years_sum_salary,\nFROM employees","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_98":{"__typename":"Paragraph","id":"5acb773e025c_98","name":"d329","type":"P","href":null,"layout":null,"metadata":null,"text":"In this query, the window declarations can not be used outside of the corresponding statement.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":39,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_99":{"__typename":"Paragraph","id":"5acb773e025c_99","name":"4b32","type":"P","href":null,"layout":null,"metadata":null,"text":"However, a named window can be defined and used in multiple statements. It is created by using the WINDOW keyword, followed by a name and the window definition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":99,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":11,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_100":{"__typename":"Paragraph","id":"5acb773e025c_100","name":"d24b","type":"P","href":null,"layout":null,"metadata":null,"text":"The named window can then be referenced in a SELECT statement, as shown in the example below.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":45,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":29,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_101":{"__typename":"Paragraph","id":"5acb773e025c_101","name":"f9f7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary,\n  fiscal_year,\n  LAG(salary)         OVER(yearly_ordered_employee)      AS previous_salary,\n  FIRST_VALUE(salary) OVER(yearly_ordered_employee)      AS first_salary,\n  SUM(salary)         OVER(yearly_ordered_employee)      AS cumulative_sum_salary,\n  AVG(salary)         OVER(yearly_ordered_employee)      AS cumulative_average_salary,\n  SUM(salary)         OVER(three_years_ordered_employee) AS three_years_sum_salary,\nFROM employees\nWINDOW \n  yearly_ordered_employee      AS (PARTITION BY name ORDER BY fiscal_year), \n  three_years_ordered_employee AS (yearly_ordered_employee RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_102":{"__typename":"Paragraph","id":"5acb773e025c_102","name":"572f","type":"P","href":null,"layout":null,"metadata":null,"text":"Using a named window has several advantages.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_103":{"__typename":"Paragraph","id":"5acb773e025c_103","name":"1716","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It can be used in multiple SELECT statements, making it easier to maintain and update your queries.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":27,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":56,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_104":{"__typename":"Paragraph","id":"5acb773e025c_104","name":"042e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It can also make the query more readable by separating the window definition from the SELECT statement and giving it a descriptive name.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":86,"end":92,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":27,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":117,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_105":{"__typename":"Paragraph","id":"5acb773e025c_105","name":"c39a","type":"P","href":null,"layout":null,"metadata":null,"text":"In the example given, the named window three_years_ordered_employee is not created independently but rather builds upon the previously defined yearly_ordered_employee window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":39,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":143,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":108,"end":134,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_106":{"__typename":"Paragraph","id":"5acb773e025c_106","name":"00af","type":"P","href":null,"layout":null,"metadata":null,"text":"The same result can be done with the first employee named window in the modified version of the query.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":43,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_107":{"__typename":"Paragraph","id":"5acb773e025c_107","name":"d076","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n   [...]\nFROM employees\nWINDOW \n  employee                     AS (PARTITION BY name),\n  yearly_ordered_employee      AS (employee ORDER BY fiscal_year),\n  three_years_ordered_employee AS (yearly_ordered_employee RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_108":{"__typename":"Paragraph","id":"5acb773e025c_108","name":"2085","type":"P","href":null,"layout":null,"metadata":null,"text":"It is possible to create a named window as an extension of another named window, as long as you","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":27,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_109":{"__typename":"Paragraph","id":"5acb773e025c_109","name":"2823","type":"ULI","href":null,"layout":null,"metadata":null,"text":"follow the proper order of the clauses: PARTITION BY before ORDER BY, and then RANGE or ROWS).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":60,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":79,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":88,"end":92,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_110":{"__typename":"Paragraph","id":"5acb773e025c_110","name":"ad87","type":"ULI","href":null,"layout":null,"metadata":null,"text":"do not extend a named window with another named window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":3,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":29,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_111":{"__typename":"Paragraph","id":"5acb773e025c_111","name":"9d45","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Check out the named window documentation for more detail.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":20,"end":46,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fwindow-function-calls#ref_named_window","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_112":{"__typename":"Paragraph","id":"5acb773e025c_112","name":"2098","type":"H3","href":null,"layout":null,"metadata":null,"text":"The QUALIFY clause","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_113":{"__typename":"Paragraph","id":"5acb773e025c_113","name":"e01b","type":"P","href":null,"layout":null,"metadata":null,"text":"The QUALIFY clause can be used in a query with a window to filter the results. It is different from the WHERE and HAVING.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":104,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":114,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":59,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":85,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_114":{"__typename":"Paragraph","id":"5acb773e025c_114","name":"375b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The WHERE clause is used to filter rows and is applied to individual records.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":47,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_115":{"__typename":"Paragraph","id":"5acb773e025c_115","name":"d414","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The HAVING clause is used to filter rows applied after a group of records has been specified.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":41,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_116":{"__typename":"Paragraph","id":"5acb773e025c_116","name":"1e72","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The QUALIFY clause is used to filter rows applied after a window function result.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":42,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_117":{"__typename":"Paragraph","id":"5acb773e025c_117","name":"971c","type":"P","href":null,"layout":null,"metadata":null,"text":"So one of the primary purposes of the QUALIFY clause is to limit the rows returned in a query based on the output of the window function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":38,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_118":{"__typename":"Paragraph","id":"5acb773e025c_118","name":"66f6","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, you may use it to only return the top rows within a given window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":46,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_119":{"__typename":"Paragraph","id":"5acb773e025c_119","name":"0d1f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary,\n  RANK() OVER(ORDER BY salary DESC) AS rank_by_salary\nFROM employees\nQUALIFY rank_by_salary \u003C= 5","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-5GPJFq9nIMNPZ7B5myW0Q.png":{"__typename":"ImageMetadata","id":"1*-5GPJFq9nIMNPZ7B5myW0Q.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_120":{"__typename":"Paragraph","id":"5acb773e025c_120","name":"904e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-5GPJFq9nIMNPZ7B5myW0Q.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_121":{"__typename":"Paragraph","id":"5acb773e025c_121","name":"eaac","type":"P","href":null,"layout":null,"metadata":null,"text":"The QUALIFY clause in this example filters the results to only include employees with a rank of 5 or lower according to their salary.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":88,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_122":{"__typename":"Paragraph","id":"5acb773e025c_122","name":"09df","type":"P","href":null,"layout":null,"metadata":null,"text":"If you do not want to include the rank_by_salary field in the output, you can define and filter using an inline, unnamed and unaliased window in the QUALIFY clause.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":34,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":149,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":113,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_123":{"__typename":"Paragraph","id":"5acb773e025c_123","name":"a782","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary\nFROM employees\nQUALIFY RANK() OVER(ORDER BY salary DESC) \u003C= 5","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_124":{"__typename":"Paragraph","id":"5acb773e025c_124","name":"9d77","type":"P","href":null,"layout":null,"metadata":null,"text":"And even if a named window does not contribute any value to the query in this particular case, it is still possible to reference it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_125":{"__typename":"Paragraph","id":"5acb773e025c_125","name":"a09a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SELECT\n  name,\n  salary\nFROM employees\nQUALIFY RANK() OVER(greatest_salary) \u003C= 5\nWINDOW greatest_salary AS (ORDER BY salary DESC)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_126":{"__typename":"Paragraph","id":"5acb773e025c_126","name":"fd2e","type":"P","href":null,"layout":null,"metadata":null,"text":"Using the QUALIFY clause is the most effective way to deduplicate data in a BigQuery table. For more information on this topic, see my article linked below.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":25,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_127":{"__typename":"Paragraph","id":"5acb773e025c_127","name":"bc27","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Deduplication in BigQuery Tables: A Comparative Study of 7 Approaches\nAnalyzing and comparing 7 ways of deduplicating rows in a BigQuery table.medium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":153,"href":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fdeduplication-in-bigquery-tables-a-comparative-study-of-7-approaches-f48966eeea2b","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":70,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fdeduplication-in-bigquery-tables-a-comparative-study-of-7-approaches-f48966eeea2b","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"1*08kcvkA64iddoMtjoErr8Q.png"}},"Paragraph:5acb773e025c_128":{"__typename":"Paragraph","id":"5acb773e025c_128","name":"3110","type":"H3","href":null,"layout":null,"metadata":null,"text":"Tips and best practices for using windows functions in BigQuery","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_129":{"__typename":"Paragraph","id":"5acb773e025c_129","name":"aee9","type":"P","href":null,"layout":null,"metadata":null,"text":"There are several tips and best practices that can help you optimize performance and readability when using window functions in BigQuery. Here are a few to consider:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":60,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":85,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_130":{"__typename":"Paragraph","id":"5acb773e025c_130","name":"f369","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Avoid unnecessary calculations by only including the columns and expressions that are necessary for your query (fewer columns). This can also help improve performance.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_131":{"__typename":"Paragraph","id":"5acb773e025c_131","name":"8f53","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Use filters wherever possible to reduce the amount of data that the window function has to process (fewer rows). This can help speed up your queries and reduce resource usage and cost.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":127,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":153,"end":183,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_132":{"__typename":"Paragraph","id":"5acb773e025c_132","name":"76d8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If you have the option to use window functions instead of other methods to solve a problem, it is often the most optimized way to do so in terms of both performance and readability.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":98,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":153,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":169,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_133":{"__typename":"Paragraph","id":"5acb773e025c_133","name":"3eaa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It is a good idea to be explicit when aliasing your columns and naming your windows. This can help others understand your queries even if they are not familiar with the concept of windowing.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_134":{"__typename":"Paragraph","id":"5acb773e025c_134","name":"d0cc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"To save time and avoid errors, it is helpful to have the documentation on your side while writing your query, paying close attention to the details and syntax.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":57,"end":70,"href":"https:\u002F\u002Fcloud.google.com\u002Fbigquery\u002Fdocs\u002Freference\u002Fstandard-sql\u002Fwindow-function-calls","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":3,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":140,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":152,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_135":{"__typename":"Paragraph","id":"5acb773e025c_135","name":"655e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Keep in mind the order of clause execution in your queries. This can affect the results of your query, so it is important to understand the order in which the clauses are applied.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_136":{"__typename":"Paragraph","id":"5acb773e025c_136","name":"3590","type":"P","href":null,"layout":null,"metadata":null,"text":"To review the final point, it is important to understand that the order in which a query is written does not determine the order in which it is executed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":62,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_137":{"__typename":"Paragraph","id":"5acb773e025c_137","name":"8d3b","type":"P","href":null,"layout":null,"metadata":null,"text":"As a fun way to illustrate this concept, here is the solution from a game we saw in our childhood.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TPjMSAsT3zaoOUOJ4a2ZPg.png":{"__typename":"ImageMetadata","id":"1*TPjMSAsT3zaoOUOJ4a2ZPg.png","originalHeight":226,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5acb773e025c_138":{"__typename":"Paragraph","id":"5acb773e025c_138","name":"511f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TPjMSAsT3zaoOUOJ4a2ZPg.png"},"text":"Image by author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_139":{"__typename":"Paragraph","id":"5acb773e025c_139","name":"dafe","type":"P","href":null,"layout":null,"metadata":null,"text":"You note, the WHERE clause filters rows, which are then aggregated and further filtered using the HAVING clause. Then the resulting rows can be processed using a window function and filtered again with the QUALIFY clause.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":14,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":98,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":206,"end":213,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":27,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":51,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":71,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_140":{"__typename":"Paragraph","id":"5acb773e025c_140","name":"237a","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, if you want to filter the final rows while also including other rows in the windowing operation, you should use the QUALIFY clause instead of the WHERE or HAVING, or your result may be incorrect.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":129,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":159,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":168,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":28,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":50,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_141":{"__typename":"Paragraph","id":"5acb773e025c_141","name":"4c3f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F*\n  Returns the daily sales of each fruit product \n  as well as the global daily sales across all categories\n*\u002F\n\nSELECT\n  sales_date,\n  product_category,\n  product_name,\n  SUM(sales_amount) OVER(PARTITION BY sales_date, product_name) AS `category_day_sales`,\n  SUM(sales_amount) OVER(PARTITION BY sales_date)               AS `global_day_sales`,\nFROM sales\n-- WHERE product_category = 'fruit'\nGROUP BY \n  product_category,\n  product_name\nQUALIFY product_category = 'fruit'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_142":{"__typename":"Paragraph","id":"5acb773e025c_142","name":"6bb3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: the QUALIFY clause can filter rows that are not the result of a window function. It only is applied after the window function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_143":{"__typename":"Paragraph","id":"5acb773e025c_143","name":"fb1c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_144":{"__typename":"Paragraph","id":"5acb773e025c_144","name":"711a","type":"P","href":null,"layout":null,"metadata":null,"text":"BigQuery windows functions are a powerful tool for data professionals looking to manipulate and transform data in new and innovative ways.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":33,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":81,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":96,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_145":{"__typename":"Paragraph","id":"5acb773e025c_145","name":"dc92","type":"P","href":null,"layout":null,"metadata":null,"text":"With a basic understanding of the syntax and usage of these functions, as well as an understanding of the key components of a window declaration, it is possible to leverage the many common windows functions available in BigQuery to achieve a wide variety of results.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":7,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":34,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":45,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":152,"end":206,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_146":{"__typename":"Paragraph","id":"5acb773e025c_146","name":"cb84","type":"P","href":null,"layout":null,"metadata":null,"text":"The advanced window frame specification and named windows allow even more flexibility and control. And the QUALIFY clause can be used to further filter the final results of a query for both windowing function outputs and previously computed results.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":107,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":13,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":69,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":145,"end":169,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_147":{"__typename":"Paragraph","id":"5acb773e025c_147","name":"2d1e","type":"P","href":null,"layout":null,"metadata":null,"text":"By following some of the tips and best practices, data professionals can improve the performance and readability of their queries.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":25,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":85,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":101,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_148":{"__typename":"Paragraph","id":"5acb773e025c_148","name":"645a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"I hope this guide has been helpful and will help you take your data analysis to the next level.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5acb773e025c_149":{"__typename":"Paragraph","id":"5acb773e025c_149","name":"f0d5","type":"BQ","href":null,"layout":null,"metadata":null,"text":"If you found it useful, please consider giving it a few claps to show your support. üëè","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:e52cf94d98af-viewerId:lo_e8d228b282f0":{"__typename":"CollectionViewerEdge","id":"collectionId:e52cf94d98af-viewerId:lo_e8d228b282f0","isEditor":false,"isMuting":false},"UserViewerEdge:userId:a8fcc1458e87-viewerId:lo_e8d228b282f0":{"__typename":"UserViewerEdge","id":"userId:a8fcc1458e87-viewerId:lo_e8d228b282f0","isMuting":false},"PostViewerEdge:postId:e0a6ca3f9502-viewerId:lo_e8d228b282f0":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:e0a6ca3f9502-viewerId:lo_e8d228b282f0"},"Tag:data":{"__typename":"Tag","id":"data","displayTitle":"Data","normalizedTagSlug":"data"},"Tag:bigquery":{"__typename":"Tag","id":"bigquery","displayTitle":"Bigquery","normalizedTagSlug":"bigquery"},"Tag:big-data":{"__typename":"Tag","id":"big-data","displayTitle":"Big Data","normalizedTagSlug":"big-data"},"Tag:sql":{"__typename":"Tag","id":"sql","displayTitle":"Sql","normalizedTagSlug":"sql"},"Tag:google-cloud-platform":{"__typename":"Tag","id":"google-cloud-platform","displayTitle":"Google Cloud Platform","normalizedTagSlug":"google-cloud-platform"},"Post:e0a6ca3f9502":{"__typename":"Post","id":"e0a6ca3f9502","collection":{"__ref":"Collection:e52cf94d98af"},"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"d285","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"f316","startIndex":8,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"b32c","startIndex":21,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"72de","startIndex":44,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1e85","startIndex":76,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"53ca","startIndex":94,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"584b","startIndex":112,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"feab","startIndex":128,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"3ca5","startIndex":143,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1b54","startIndex":148,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:5acb773e025c_0"},{"__ref":"Paragraph:5acb773e025c_1"},{"__ref":"Paragraph:5acb773e025c_2"},{"__ref":"Paragraph:5acb773e025c_3"},{"__ref":"Paragraph:5acb773e025c_4"},{"__ref":"Paragraph:5acb773e025c_5"},{"__ref":"Paragraph:5acb773e025c_6"},{"__ref":"Paragraph:5acb773e025c_7"},{"__ref":"Paragraph:5acb773e025c_8"},{"__ref":"Paragraph:5acb773e025c_9"},{"__ref":"Paragraph:5acb773e025c_10"},{"__ref":"Paragraph:5acb773e025c_11"},{"__ref":"Paragraph:5acb773e025c_12"},{"__ref":"Paragraph:5acb773e025c_13"},{"__ref":"Paragraph:5acb773e025c_14"},{"__ref":"Paragraph:5acb773e025c_15"},{"__ref":"Paragraph:5acb773e025c_16"},{"__ref":"Paragraph:5acb773e025c_17"},{"__ref":"Paragraph:5acb773e025c_18"},{"__ref":"Paragraph:5acb773e025c_19"},{"__ref":"Paragraph:5acb773e025c_20"},{"__ref":"Paragraph:5acb773e025c_21"},{"__ref":"Paragraph:5acb773e025c_22"},{"__ref":"Paragraph:5acb773e025c_23"},{"__ref":"Paragraph:5acb773e025c_24"},{"__ref":"Paragraph:5acb773e025c_25"},{"__ref":"Paragraph:5acb773e025c_26"},{"__ref":"Paragraph:5acb773e025c_27"},{"__ref":"Paragraph:5acb773e025c_28"},{"__ref":"Paragraph:5acb773e025c_29"},{"__ref":"Paragraph:5acb773e025c_30"},{"__ref":"Paragraph:5acb773e025c_31"},{"__ref":"Paragraph:5acb773e025c_32"},{"__ref":"Paragraph:5acb773e025c_33"},{"__ref":"Paragraph:5acb773e025c_34"},{"__ref":"Paragraph:5acb773e025c_35"},{"__ref":"Paragraph:5acb773e025c_36"},{"__ref":"Paragraph:5acb773e025c_37"},{"__ref":"Paragraph:5acb773e025c_38"},{"__ref":"Paragraph:5acb773e025c_39"},{"__ref":"Paragraph:5acb773e025c_40"},{"__ref":"Paragraph:5acb773e025c_41"},{"__ref":"Paragraph:5acb773e025c_42"},{"__ref":"Paragraph:5acb773e025c_43"},{"__ref":"Paragraph:5acb773e025c_44"},{"__ref":"Paragraph:5acb773e025c_45"},{"__ref":"Paragraph:5acb773e025c_46"},{"__ref":"Paragraph:5acb773e025c_47"},{"__ref":"Paragraph:5acb773e025c_48"},{"__ref":"Paragraph:5acb773e025c_49"},{"__ref":"Paragraph:5acb773e025c_50"},{"__ref":"Paragraph:5acb773e025c_51"},{"__ref":"Paragraph:5acb773e025c_52"},{"__ref":"Paragraph:5acb773e025c_53"},{"__ref":"Paragraph:5acb773e025c_54"},{"__ref":"Paragraph:5acb773e025c_55"},{"__ref":"Paragraph:5acb773e025c_56"},{"__ref":"Paragraph:5acb773e025c_57"},{"__ref":"Paragraph:5acb773e025c_58"},{"__ref":"Paragraph:5acb773e025c_59"},{"__ref":"Paragraph:5acb773e025c_60"},{"__ref":"Paragraph:5acb773e025c_61"},{"__ref":"Paragraph:5acb773e025c_62"},{"__ref":"Paragraph:5acb773e025c_63"},{"__ref":"Paragraph:5acb773e025c_64"},{"__ref":"Paragraph:5acb773e025c_65"},{"__ref":"Paragraph:5acb773e025c_66"},{"__ref":"Paragraph:5acb773e025c_67"},{"__ref":"Paragraph:5acb773e025c_68"},{"__ref":"Paragraph:5acb773e025c_69"},{"__ref":"Paragraph:5acb773e025c_70"},{"__ref":"Paragraph:5acb773e025c_71"},{"__ref":"Paragraph:5acb773e025c_72"},{"__ref":"Paragraph:5acb773e025c_73"},{"__ref":"Paragraph:5acb773e025c_74"},{"__ref":"Paragraph:5acb773e025c_75"},{"__ref":"Paragraph:5acb773e025c_76"},{"__ref":"Paragraph:5acb773e025c_77"},{"__ref":"Paragraph:5acb773e025c_78"},{"__ref":"Paragraph:5acb773e025c_79"},{"__ref":"Paragraph:5acb773e025c_80"},{"__ref":"Paragraph:5acb773e025c_81"},{"__ref":"Paragraph:5acb773e025c_82"},{"__ref":"Paragraph:5acb773e025c_83"},{"__ref":"Paragraph:5acb773e025c_84"},{"__ref":"Paragraph:5acb773e025c_85"},{"__ref":"Paragraph:5acb773e025c_86"},{"__ref":"Paragraph:5acb773e025c_87"},{"__ref":"Paragraph:5acb773e025c_88"},{"__ref":"Paragraph:5acb773e025c_89"},{"__ref":"Paragraph:5acb773e025c_90"},{"__ref":"Paragraph:5acb773e025c_91"},{"__ref":"Paragraph:5acb773e025c_92"},{"__ref":"Paragraph:5acb773e025c_93"},{"__ref":"Paragraph:5acb773e025c_94"},{"__ref":"Paragraph:5acb773e025c_95"},{"__ref":"Paragraph:5acb773e025c_96"},{"__ref":"Paragraph:5acb773e025c_97"},{"__ref":"Paragraph:5acb773e025c_98"},{"__ref":"Paragraph:5acb773e025c_99"},{"__ref":"Paragraph:5acb773e025c_100"},{"__ref":"Paragraph:5acb773e025c_101"},{"__ref":"Paragraph:5acb773e025c_102"},{"__ref":"Paragraph:5acb773e025c_103"},{"__ref":"Paragraph:5acb773e025c_104"},{"__ref":"Paragraph:5acb773e025c_105"},{"__ref":"Paragraph:5acb773e025c_106"},{"__ref":"Paragraph:5acb773e025c_107"},{"__ref":"Paragraph:5acb773e025c_108"},{"__ref":"Paragraph:5acb773e025c_109"},{"__ref":"Paragraph:5acb773e025c_110"},{"__ref":"Paragraph:5acb773e025c_111"},{"__ref":"Paragraph:5acb773e025c_112"},{"__ref":"Paragraph:5acb773e025c_113"},{"__ref":"Paragraph:5acb773e025c_114"},{"__ref":"Paragraph:5acb773e025c_115"},{"__ref":"Paragraph:5acb773e025c_116"},{"__ref":"Paragraph:5acb773e025c_117"},{"__ref":"Paragraph:5acb773e025c_118"},{"__ref":"Paragraph:5acb773e025c_119"},{"__ref":"Paragraph:5acb773e025c_120"},{"__ref":"Paragraph:5acb773e025c_121"},{"__ref":"Paragraph:5acb773e025c_122"},{"__ref":"Paragraph:5acb773e025c_123"},{"__ref":"Paragraph:5acb773e025c_124"},{"__ref":"Paragraph:5acb773e025c_125"},{"__ref":"Paragraph:5acb773e025c_126"},{"__ref":"Paragraph:5acb773e025c_127"},{"__ref":"Paragraph:5acb773e025c_128"},{"__ref":"Paragraph:5acb773e025c_129"},{"__ref":"Paragraph:5acb773e025c_130"},{"__ref":"Paragraph:5acb773e025c_131"},{"__ref":"Paragraph:5acb773e025c_132"},{"__ref":"Paragraph:5acb773e025c_133"},{"__ref":"Paragraph:5acb773e025c_134"},{"__ref":"Paragraph:5acb773e025c_135"},{"__ref":"Paragraph:5acb773e025c_136"},{"__ref":"Paragraph:5acb773e025c_137"},{"__ref":"Paragraph:5acb773e025c_138"},{"__ref":"Paragraph:5acb773e025c_139"},{"__ref":"Paragraph:5acb773e025c_140"},{"__ref":"Paragraph:5acb773e025c_141"},{"__ref":"Paragraph:5acb773e025c_142"},{"__ref":"Paragraph:5acb773e025c_143"},{"__ref":"Paragraph:5acb773e025c_144"},{"__ref":"Paragraph:5acb773e025c_145"},{"__ref":"Paragraph:5acb773e025c_146"},{"__ref":"Paragraph:5acb773e025c_147"},{"__ref":"Paragraph:5acb773e025c_148"},{"__ref":"Paragraph:5acb773e025c_149"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:a8fcc1458e87"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","primaryTopic":{"__ref":"Topic:decb52b64abf"},"topics":[{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"5acb773e025c","postResponses":{"__typename":"PostResponses","count":2},"responseDistribution":"NOT_DISTRIBUTED","clapCount":464,"title":"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals","isSeries":false,"sequence":null,"uniqueSlug":"bigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","socialTitle":"","socialDek":"","canonicalUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502","metaDescription":"","latestPublishedAt":1687725278652,"readingTime":12.639622641509435,"previewContent":{"__typename":"PreviewContent","subtitle":"A complete guide for maximizing the potential of BigQuery WINDOW functions to manipulate and transform data."},"previewImage":{"__ref":"ImageMetadata:1*YFnqJT_pzovNPxnBtLuEQg.png"},"isShortform":false,"seoMetaTags":{"__typename":"SEOMetaTags","jsonLd":"{\"@context\":\"https:\u002F\u002Fschema.org\",\"@type\":\"SocialMediaPosting\",\"image\":[\"https:\u002F\u002Fmiro.medium.com\u002F1*YFnqJT_pzovNPxnBtLuEQg.png\"],\"url\":\"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502\",\"dateCreated\":\"2023-01-09T15:20:05Z\",\"datePublished\":\"2023-01-09T15:20:05Z\",\"dateModified\":\"2023-06-25T20:34:38Z\",\"headline\":\"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals\",\"name\":\"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals\",\"description\":\"This article simplifies the concept of BigQuery's windows functions to enhance your data analysis skills and improve your understanding of BigQuery.\",\"identifier\":\"e0a6ca3f9502\",\"author\":{\"@type\":\"Person\",\"name\":\"Axel Thevenot üê£\",\"url\":\"https:\u002F\u002Fmedium.com\u002F@axel-thevenot\"},\"creator\":[\"Axel Thevenot üê£\"],\"publisher\":{\"@type\":\"Organization\",\"name\":\"Google Cloud - Community\",\"url\":\"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\",\"logo\":{\"@type\":\"ImageObject\",\"width\":192,\"height\":192,\"url\":\"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:192\u002F1*FUjLiCANvATKeaJEeg20Rw.png\"}},\"mainEntityOfPage\":\"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbigquery-window-functions-advanced-techniques-for-data-professionals-e0a6ca3f9502\",\"isAccessibleForFree\":true}"},"seoDescription":"This article simplifies the concept of BigQuery's windows functions to enhance your data analysis skills and improve your understanding of BigQuery.","shortformType":"SHORTFORM_TYPE_LINK","firstPublishedAt":1673277605737,"viewerEdge":{"__ref":"PostViewerEdge:postId:e0a6ca3f9502-viewerId:lo_e8d228b282f0"},"seoTitle":"BigQuery WINDOW Functions | Advanced Techniques for Data Professionals","isSuspended":false,"license":"PUBLIC_DOMAIN","tags":[{"__ref":"Tag:data"},{"__ref":"Tag:bigquery"},{"__ref":"Tag:big-data"},{"__ref":"Tag:sql"},{"__ref":"Tag:google-cloud-platform"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":3005,"layerCake":3}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.0e1ee4c4.js"></script><script src="https://cdn-client.medium.com/lite/static/js/723.093de8f1.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.09e66f22.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.47ae8b31.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.851fdaca.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5052.eb638269.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/628.add32a62.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4237.091bc151.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6840.4f082ee3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3326.8a80e879.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7566.fa51707d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7908.908acb8a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3927.2f9f3eed.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8640.0d3bced2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9967.f31ca2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.c6e20496.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5429.931b7269.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.c53435ab.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5522.e9951c29.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5660.6336e947.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.d5148d55.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.6c66e3cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1887.e955bdb2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.35c5b2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.3f8d607c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3877.96683729.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9256.629cdc7e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.71979c5d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.76c298be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.6579eeda.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.6236ad3b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.7017067b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3960.16e44094.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.a239456b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2698.9eecb474.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.ee0dd7bf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.5b775609.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.e940a3b4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.d61aa7c4.chunk.js"></script>
<script id="__LOADABLE_REQUIRED_CHUNKS__" type="application/json">[]</script>
<script id="__LOADABLE_REQUIRED_CHUNKS___ext" type="application/json">{"namedChunks":[]}</script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970280827aabde83',t:'MTc1NTM2Mzc3NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;970280827aabde83&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.8.0&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<script src="https://accounts.google.com/gsi/client" async=""></script><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-lto6df1kybh7" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9tZWRpdW0uY29tOjQ0Mw..&amp;hl=en-GB&amp;v=07cvpCr3Xe3g2ttJNUkC6W0J&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=15000&amp;cb=ifjcsqpo64ag"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div></body></html>